# Part D
## コア構成

1. **はじめに** ............................................................................................... 202  
2. **コア構成** ................................................................................. 203  
   2.1 **コア-コントローラ構成** ..................................................... 203  
      2.1.1 BR/EDR コア-コントローラ構成 ....................... 203  
      2.1.2 LE コア-コントローラ構成 ................................ 204  
      2.1.3 BR/EDR/LE コア-コントローラ構成 .................. 204  
      2.1.4 【このセクションは使用されていません】 ................................... 205  
      2.1.5 【このセクションは使用されていません】 ................................... 205  
   2.2 **コア-ホスト構成** ............................................................ 205  
      2.2.1 BR/EDR コア-ホスト構成 ............................... 205  
      2.2.2 LE コア-ホスト構成 ........................................ 205  
      2.2.3 BR/EDR/LE コア-ホスト構成 .......................... 206  
      2.2.4 【このセクションは使用されていません】 ................................... 206  
      2.2.5 【このセクションは使用されていません】 ................................... 206  
   2.3 **コア-コンプリート構成** .................................................... 206  
      2.3.1 BR/EDR コア-コンプリート構成 ....................... 206  
      2.3.2 LE コア-コンプリート構成 ................................ 206  
      2.3.3 BR/EDR/LE コア-コンプリート構成 .................. 207  
      2.3.4 【このセクションは使用されていません】 ................................... 207  
      2.3.5 【このセクションは使用されていません】 ................................... 207  
   2.4 **その他のコアレイヤー** ........................................................................ 207  

3. **異なるバージョンの要件を混合する場合の要件** ......................................... 208
4. **機能とその種類** .......................................................................... 209  
5. **コア仕様追加** .................................................................... 213
# アーキテクチャ、変更履歴、および表記法
## 仕様書 Volume 1

### Part A
#### アーキテクチャ

1. **一般的な説明** .................................................................................. 223  
   1.1 BR/EDR 動作の概要 ................................................... 224  
   1.2 Bluetooth Low Energy 動作の概要 ............................. 226  
   1.3 【このセクションは使用されていません】 ................................................... 232  
   1.4 用語 .............................................................................. 232  

2. **コアシステムアーキテクチャ** ......................................................................... 239  
   2.1 コアのアーキテクチャブロック ............................................................. 242  
      2.1.1 ホストのアーキテクチャブロック .............................................. 243  
      2.1.2 BR/EDR/LE コントローラのアーキテクチャブロック ................. 244  
      2.1.3 【このセクションは使用されていません】 ................................... 247  

3. **トランスポートアーキテクチャ** .............................................................................. 248  
   3.1 コアのトラフィックベアラー ...................................................................... 248  
      3.1.1 フレームデータトラフィック ....................................................... 250  
      3.1.2 フレームなしデータトラフィック ................................................... 251  
      3.1.3 トラフィックベアラーの信頼性 .......................................... 252  
   3.2 トランスポートアーキテクチャのエンティティ ..................................................... 254  
      3.2.1 BR/EDR 汎用パケット構造 ................................ 254  
      3.2.2 LE 汎用パケット構造 ......................................... 256  
      3.2.3 LE チャネルサウンディング汎用パケット構造および信号フォーマット .................................................... 260  
   3.3 物理チャネル ....................................................................... 261  
      3.3.1 BR/EDR 物理チャネル .......................................... 262  
      3.3.2 LE 物理チャネル ................................................... 268  
      3.3.3 【このセクションは使用されていません】 ................................... 275  
   3.4 物理リンク ............................................................................... 275  
      3.4.1 基本および適応ピコネット物理チャネルでサポートされる BR/EDR リンク .............................. 276  
      3.4.2 スキャニング物理チャネルでサポートされる BR/EDR リンク ........................................................ 277  
      3.4.3 LE 物理チャネルでサポートされる LE リンク ......... 277  
      3.4.4 【このセクションは使用されていません】 ................................... 279  
   3.5 論理リンクおよび論理トランスポート ............................................. 279  
      3.5.1 キャスティング ......................................................................... 281  
      3.5.2 スケジューリングと確認方式 .................. 281
      3.5.3 データのクラス ................................................................ 282  
      3.5.4 論理トランスポート ........................................................ 283  
      3.5.5 論理リンク ................................................................. 289  
   3.6 L2CAP チャネル ......................................................................... 291  
   3.7 同期適応レイヤー（ISOAL） ...................................... 292  
   3.8 電力制御 .............................................................................. 292  
      3.8.1 BR/EDR における電力制御 ............................................ 292  
      3.8.2 LE における電力制御 ...................................................... 293  

4. **通信トポロジーと動作** ................................................ 294  
   4.1 ピコネットトポロジー .......................................................................... 294  
      4.1.1 BR/EDR トポロジー ......................................................... 294  
      4.1.2 LE トポロジー .................................................................. 297  
   4.2 運用手順およびモード ............................................ 299  
      4.2.1 BR/EDR 手順 .................................................... 299  
      4.2.2 LE 手順 ............................................................. 303  
      4.2.3 【このセクションは使用されていません】 ................................... 308  

5. **セキュリティ概要** ..................................................................................... 309  
   5.1 セキュリティアーキテクチャ ................................................................... 309  
   5.2 BR/EDR セキュアシンプルペアリング .................................................. 311  
      5.2.1 セキュリティの目標 .............................................................. 312  
      5.2.2 受動的盗聴防止 ....................................................... 312  
      5.2.3 中間者攻撃防止 ....................................... 313  
      5.2.4 アソシエーションモデル ...................................................... 313  
   5.3 セキュア接続のみモード ................................................. 316  
   5.4 LE セキュリティ ................................................................................... 317  
      5.4.1 アソシエーションモデル ...................................................... 317  
      5.4.2 キー生成 ............................................................ 317  
      5.4.3 暗号化 .................................................................... 317  
      5.4.4 署名付きデータ ................................................................. 318  
      5.4.5 プライバシー機能 ............................................................. 318  
      5.4.6 暗号化された広告データ ......................................... 319  
   5.5 【このセクションは使用されていません】 ................................................... 320  
   5.6 BR/EDR と LE 物理トランスポート間のキー生成 ... 320  

6. **Bluetooth アプリケーションアーキテクチャ** .......................................................... 321  
   6.1 Bluetooth プロファイル ........................................................................ 321  
   6.2 汎用アクセスプロファイル ................................................................ 321  
   6.3 プロファイル階層 .......................................................................... 322  
   6.4 汎用属性アーキテクチャ ..................................................... 323  
      6.4.1 属性プロトコル ......................................................... 323  
      6.4.2 汎用属性プロファイル ............................................... 324
   6.5 GATTベースのプロファイル階層 ..................................................... 324  
      6.5.1 サービス ......................................................................... 325  
      6.5.2 インクルードされたサービス ......................................................... 326  
      6.5.3 キャラクタリスティック ............................................................... 326  
   6.6 【このセクションは使用されていません】 ................................................... 326  

7. **共存とコロケーション** ................................................................... 327  
   7.1 共存とコロケーションをサポートするコア機能 ................ 327  
   7.2 アダプティブ周波数ホッピング ...................................................... 328  
   7.3 Bluetoothデバイスと無線LANデバイス間の共存 ................................................................................ 329  
   7.4 モバイル無線標準（MWS）共存 ................................. 329  
   7.5 Bluetoothを外部タイミングソースと同期させる ............. 332  
   7.6 ピコネットクロック調整 ............................................................ 333  
   7.7 スロット可用性マスク（SAM） ....................................................... 334  

8. **Bluetooth Low Energyを使用した方向検出** ...................................... 335  
   8.1 到着角度（AoA）方式 ..................................................... 335  
   8.2 出発角度（AoD）方式 ............................................... 336  

9. **Bluetooth Low Energyを使用したチャネルサウンディング** .................................. 339  
   9.1 チャネルサウンディング手順 ..................................................... 339  
   9.2 位相および振幅情報に基づく距離推定 ........................ 340  
   9.3 RTTパケットに基づく距離推定 ................................ 342  
   9.4 セキュリティ機能 ......................................................................... 343  

# Part B  
## 略語および略称  
1. 略語および略称の一覧 ....................................................... 346  

# Part C  
## コア仕様変更履歴  
1. 削除された機能 ..................................................................................... 359  
2. v1.1からv1.2への変更 ....................................................................... 360  
   2.1 新機能 ............................................................................... 360  
   2.2 構造の変更 ....................................................................... 360  
   2.3 非推奨機能リスト .............................................................. 361  
   2.4 言葉遣いの変更 .................................................................... 361  
   2.5 用語の変更 ............................................................... 361  

3. v1.2からv2.0 + EDRへの変更 ............................................................ 362
   3.1 新機能 ............................................................................... 362  
   3.2 非推奨機能 .................................................................... 362  

4. **v2.0 + EDRからv2.1 + EDRへの変更** ................................................ 363  
   4.1 新機能 ............................................................................... 363  
   4.2 削除された機能 ....................................................................... 363  

5. **v2.1 + EDRからv3.0 + HSへの変更** .................................................. 364  
   5.1 新機能 ............................................................................... 364  
   5.2 削除された機能 ....................................................................... 364  

6. **v3.0 + HSからv4.0への変更** .............................................................. 365  
   6.1 新機能 ............................................................................... 365  
   6.2 削除された機能 ....................................................................... 365  

7. **v4.0からv4.1への変更** ....................................................................... 366  
   7.1 新機能 ............................................................................... 366  
      7.1.1 CSA 4で追加された機能 - v4.1に統合 ............. 366  
      7.1.2 CSA 3で追加された機能 - v4.1に統合 ............. 366  
      7.1.3 CSA 2で追加された機能 - v4.1に統合 ............. 367  
   7.2 削除された機能 ....................................................................... 367  

8. **v4.1からv4.2への変更** ....................................................................... 368  
   8.1 新機能 ............................................................................... 368  
   8.2 v4.2に統合されたエラッタ .......................................................... 368  

9. **v4.2からv5.0への変更** ....................................................................... 370  
   9.1 新機能 ............................................................................... 370  
      9.1.1 CSA5で追加された機能 - v5.0に統合 .............. 370  
   9.2 削除された機能 ....................................................................... 370  
   9.3 プライバシーエラッタ .............................................................................. 370  
   9.4 v5.0に統合されたエラッタ .......................................................... 371  

10. **v5.0からv5.1への変更** ....................................................................... 375  
   10.1 新機能 ............................................................................... 375  
      10.1.1 CSA6で追加された機能 - v5.1に統合 .............. 375  
   10.2 削除された機能 ....................................................................... 375  
   10.3 セキュリティエラッタ .......................................................................... 375  
   10.4 v5.1に統合されたエラッタ .......................................................... 375  

11. **v5.1からv5.2への変更** ....................................................................... 378  
   11.1 新機能 ............................................................................... 378  
   11.2 セキュリティエラッタ .......................................................................... 378  
   11.3 v5.2に統合されたエラッタ .......................................................... 378
12. **v5.2からv5.3への変更** ....................................................................... 380  
   12.1 新機能 ............................................................................... 380  
   12.2 削除された機能 ....................................................................... 380  
   12.3 v5.3に統合されたエラッタ .......................................................... 380  
   12.4 グローバル用語の変更 ........................................................ 383  

13. **v5.3からv5.4への変更** ....................................................................... 385  
   13.1 新機能 ............................................................................... 385  
   13.2 削除された機能 ....................................................................... 385  
   13.3 v5.4に統合されたエラッタ .......................................................... 385  

14. **v5.4からv6.0への変更** ....................................................................... 388  
   14.1 新機能 ............................................................................... 388  
   14.2 削除された機能 ....................................................................... 388  
   14.3 v6.0に統合されたエラッタ .......................................................... 388  

# Part D  
【このパートは使用されていません】

# Part E  
## 一般的な用語および解釈  

1. **言語表記法** ............................................................................. 395  
   1.1 【このセクションは使用されていません】 ................................................... 395  
   1.2 【このセクションは使用されていません】 ................................................... 395  
   1.3 【このセクションは使用されていません】 ................................................... 395  
   1.4 【このセクションは使用されていません】 ................................................... 395  
   1.5 【このセクションは使用されていません】 ................................................... 395  
   1.6 【このセクションは使用されていません】 ................................................... 395  
   1.7 実装の代替案 ........................................................ 395  
   1.8 不一致 .............................................................................. 396  
   1.9 適切な言語表現 ................................................................. 396  

2. **一般的な解釈のルール** ..................................................................... 397  
   2.1 バイナリおよび16進値の解釈 .................................................. 397  
   2.2 ビット番号およびビットフィールド ............................................................ 397  
   2.3 ビット値の指定 ............................................................ 397  
   2.4 特定の目的に制限された値 ................................................... 398  
      2.4.1 将来の使用のために予約 ............................................... 398  
      2.4.2 以前使用された値 ........................................................... 398  
      2.4.3 仕様開発目的で予約された値 ...... 399  
   2.5 チェックサムおよびその他の計算における無効値の使用 ........ 399  
   2.6 割り当て番号の要件 .................................................. 399
   2.7 無効な動作への対応 ................................................... 399  
   2.8 値の範囲 ........................................................................ 401  
   2.9 型名 ................................................................................ 401  
      2.9.1 基本型 .................................................................. 402  
      2.9.2 配列型 ................................................................... 402  
      2.9.3 可変長型 ................................................... 403  
   2.10 数学的表記法 ........................................................... 403  
   2.11 要件ステータスシンボル ....................................................... 405  
   2.12 表の構造 ............................................................................. 405  
   2.13 HCIコマンドおよびイベントの参照 ................................. 406  

3. **命名規則** ................................................................................. 407  
   3.1 BR/EDR ....................................................................................... 407  
   3.2 Bluetooth Low Energy ................................................................. 407  
      3.2.1 リンク層PDU .......................................................... 407  

# Part F  
## コントローラエラーコード  

1. **エラーコードの概要** ........................................................................... 413  
   1.1 使用説明 ...................................................................... 413  
   1.2 【このセクションは使用されていません】 ................................................... 413  
   1.3 エラーコードの一覧 ....................................................................... 413  

2. **エラーコードの説明** ........................................................................... 416  
   2.1 不明なHCIコマンド (0x01) .................................................. 416  
   2.2 不明な接続識別子 (0x02) ........................................ 416  
   2.3 ハードウェア障害 (0x03) ............................................................. 416  
   2.4 ページタイムアウト (0x04) ................................................................... 416  
   2.5 認証失敗 (0x05) ...................................................... 416  
   2.6 PINまたはキーが見つからない (0x06) ........................................................... 416  
   2.7 メモリ容量超過 (0x07) ............................................ 416  
   2.8 接続タイムアウト (0x08) ......................................................... 417  
   2.9 接続制限超過 (0x09) ............................................. 417  
   2.10 同期接続のデバイスへの制限超過 (0x0A) .... 417  
   2.11 接続がすでに存在する (0x0B) ............................................... 417  
   2.12 コマンドが許可されていない (0x0C) ..................................................... 417  
   2.13 リソース制限により接続拒否 (0x0D) ............. 417  
   2.14 セキュリティ上の理由で接続拒否 (0x0E) ............... 417  
   2.15 許容できないBD_ADDRにより接続拒否 (0x0F) ... 418  
   2.16 接続承諾タイムアウト超過 (0x10) ............................ 418  
   2.17 未対応の機能またはパラメータ値 (0x11) ....................... 418  
   2.18 無効なHCIコマンドパラメータ (0x12) .................................. 418
   2.19 リモートユーザーによる接続終了 (0x13) .............................. 418  
   2.20 リソース不足によるリモートデバイスの接続終了 (0x14) ........................................................................ 419  
   2.21 電源オフによるリモートデバイスの接続終了 (0x15) .......................................................................................... 419  
   2.22 ローカルホストによる接続終了 (0x16) ............................. 419  
   2.23 繰り返しの試行 (0x17) .......................................................... 419  
   2.24 ペアリングが許可されていない (0x18) .......................................................... 419  
   2.25 不明なLMP PDU (0x19) ......................................................... 419  
   2.26 サポートされていないリモート機能 (0x1A) ......................................... 419  
   2.27 SCOオフセットが拒否された (0x1B) ....................................................... 419  
   2.28 SCO間隔が拒否された (0x1C) ..................................................... 420  
   2.29 SCOエアモードが拒否された (0x1D) .................................................. 420  
   2.30 無効なLMPパラメータ / 無効なLLパラメータ (0x1E) ............ 420  
   2.31 特定されていないエラー (0x1F) ............................................................. 420  
   2.32 サポートされていないLMPパラメータ値 / サポートされていないLLパラメータ値 (0x20) .............................................................. 420  
   2.33 役割変更が許可されていない (0x21) ................................................ 420  
   2.34 LMP応答タイムアウト / LL応答タイムアウト (0x22) ............. 421  
   2.35 LMPエラートランザクション衝突 / LL手続き衝突 (0x23) 421  
   2.36 LMP PDUが許可されていない (0x24) ..................................................... 421  
   2.37 暗号化モードが許容されていない (0x25) ..................................... 421  
   2.38 リンクキーを変更できない (0x26) ........................................... 421  
   2.39 要求されたQoSがサポートされていない (0x27) ........................................ 421  
   2.40 インスタントが経過した (0x28) ................................................................. 421  
   2.41 ユニットキーを使用したペアリングがサポートされていない (0x29) ................................ 421  
   2.42 異なるトランザクションの衝突 (0x2A) ......................................... 422  
   2.43 QoSが許容できないパラメータ (0x2C) ........................................ 422  
   2.44 QoSが拒否された (0x2D) .................................................................. 422  
   2.45 チャネル評価がサポートされていない (0x2E) .............................. 422  
   2.46 セキュリティが不十分 (0x2F) .......................................................... 422  
   2.47 必須範囲外のパラメータ (0x30) ................................ 422  
   2.48 役割変更が保留中 (0x32) ........................................................ 422  
   2.49 予約スロット違反 (0x34) .................................................... 422  
   2.50 役割変更に失敗 (0x35) ........................................................... 423  
   2.51 拡張問い合わせ応答が大きすぎる (0x36) ............................. 423  
   2.52 ホストによってサポートされていないセキュアシンプルペアリング (0x37) ................. 423  
   2.53 ホストがビジー – ペアリング (0x38) ........................................................... 423  
   2.54 適切なチャネルが見つからずに接続が拒否された (0x39) 423  
   2.55 コントローラがビジー (0x3A) ................................................................ 423  
   2.56 許容できない接続パラメータ (0x3B) ............................ 423  
   2.57 広告タイムアウト (0x3C) ......................................................... 424  
   2.58 MICの失敗による接続終了 (0x3D) ..................... 424
   2.59 接続の確立に失敗 / 同期タイムアウト (0x3E) ............................................................................ 424  
   2.60 【このセクションは使用されていません】 ................................................... 424  
   2.61 粗時計調整が拒否されたが、クロックドラッギングを使用して調整を試みる (0x40) ...................................................... 424  
   2.62 Type0サブマップが定義されていない (0x41) ............................................. 424  
   2.63 不明な広告識別子 (0x42) ........................................ 424  
   2.64 制限に達した (0x43) .................................................................. 425  
   2.65 ホストによって操作がキャンセルされた (0x44) ........................................... 425  
   2.66 パケットが長すぎる (0x45) .............................................................. 425  
   2.67 遅すぎる (0x46) ........................................................................... 425  
   2.68 早すぎる (0x47) .......................................................................... 425  
   2.69 チャネルが不十分 (0x48) ........................................................ 425

# BR/EDR コントローラ
## 仕様書 Volume 2

### Part A
#### 無線仕様

1. **適用範囲** ......................................................................................................... 430  
   1.1 **要件** .............................................................................. 430  
      1.1.1 π/4-DQPSK変調 ............................................... 431  
      1.1.2 8DPSK変調 ...................................................... 431  
      1.1.3 3スロットパケット ............................................................... 431  
      1.1.4 5スロットパケット ............................................................... 432  
      1.1.5 電力制御 ............................................................... 432  
      1.1.6 強化された電力制御 .............................................. 432  

2. **周波数帯域とチャネル配置** ......................................... 433  

3. **送信機の特性** ...................................................................... 434  
   3.1 **基本レート** ................................................................................... 434  
      3.1.1 変調特性 ........................................... 434  
      3.1.2 スプリアス放射 ...................................................... 435  
      3.1.3 無線周波数許容範囲 ........................................... 436  
   3.2 **拡張データレート** ................................................................... 436  
      3.2.1 変調特性 ........................................... 436  
      3.2.2 スプリアス放射 ...................................................... 439  
      3.2.3 無線周波数許容範囲 ........................................... 440  
      3.2.4 相対送信電力 ............................................... 441  

4. **受信機の特性** .......................................................................... 442  
   4.1 **基本レート** ................................................................................... 442  
      4.1.1 実際の感度レベル .................................................. 442  
      4.1.2 干渉性能 ............................................ 442  
      4.1.3 帯域外ブロッキング ................................................... 443  
      4.1.4 インターモジュレーション特性 .................................... 443  
      4.1.5 最大使用可能レベル ................................................. 444  
      4.1.6 受信信号強度表示 .................................... 444  
      4.1.7 リファレンス信号定義 .......................................... 444  
   4.2 **拡張データレート** ................................................................... 444  
      4.2.1 実際の感度レベル .................................................. 444  
      4.2.2 BERフロア性能 ................................................ 444  
      4.2.3 干渉性能 ............................................ 444  
      4.2.4 最大使用可能レベル ................................................. 445
      4.2.5 帯域外およびインターモジュレーション特性 ......... 445  
      4.2.6 リファレンス信号定義 .......................................... 446  

5. **電力管理** .................................................................................. 447  
   5.1 電力クラス ............................................................................. 447  
   5.2 電力制御 .............................................................................. 447  
   5.3 強化された電力制御 ............................................................. 448  

### 付録 A テスト条件 ................................................................................ 449  
   A.1 標準的なテスト条件 ............................................................... 449  
      A.1.1 標準温度 ................................................... 449  
      A.1.2 標準電源 ................................................. 449  
   A.2 【このセクションは使用されていません】 ................................................... 449  

### 付録 B 【この付録は使用されていません】 ................................................ 450  

### 付録 C 変調精度の定義 ..................................................... 451  
   C.1 拡張データレート変調精度 ................................. 451  
      C.1.1 RMS DEVM ................................................................. 453  
      C.1.2 ピーク DEVM ................................................................. 453  

# Part B  
## ベースバンド仕様

1. **一般的な説明** .................................................................................. 463  
   1.1 Bluetoothクロック ............................................................................ 464  
   1.2 Bluetoothデバイスアドレッシング ...................................................... 465  
      1.2.1 予約アドレス .................................................... 466  
   1.3 アクセスコード .............................................................................. 467  

2. **物理チャネル** ..................................................................................... 468  
   2.1 物理チャネルの定義 .......................................................... 469  
   2.2 基本ピコネット物理チャネル ................................................... 469  
      2.2.1 セントラルおよびペリフェラルの役割 ........................................ 469  
      2.2.2 ホッピング特性 ............................................... 470  
      2.2.3 タイムスロット .................................................................... 470  
      2.2.4 ピコネットクロック .............................................................. 471  
      2.2.5 送信/受信タイミング ................................................ 471  
   2.3 適応ピコネット物理チャネル ............................................... 475  
      2.3.1 ホッピング特性 ............................................... 475  
   2.4 ページスキャン物理チャネル ........................................................ 475  
      2.4.1 ページングのためのクロック推定 ............................................ 476  
      2.4.2 ホッピング特性 ............................................... 476  
      2.4.3 ページング手順タイミング .............................................. 476
      2.4.4 ページ応答タイミング .................................................. 477  
   2.5 問い合わせスキャン物理チャネル ..................................................... 479  
      2.5.1 問い合わせのためのクロック ........................................................... 479  
      2.5.2 ホッピング特性 ............................................... 480  
      2.5.3 問い合わせ手順のタイミング .............................................. 480  
      2.5.4 問い合わせ応答のタイミング ............................................... 480  

   2.6 ホップ選択 .............................................................................. 481  
      2.6.1 一般選択方式 ........................................... 482  
      2.6.2 選択カーネル ........................................................... 485  
      2.6.3 適応ホップ選択カーネル ...................................... 488  
      2.6.4 制御ワード ................................................................ 490  

   2.7 同期スキャン物理チャネル ...................................... 494  
      2.7.1 ホッピング特性 ............................................... 494  
      2.7.2 同期トレイン手順のタイミング ...................... 494  
      2.7.3 同期スキャン手順のタイミング ...................... 496  

3. **物理リンク** ............................................................................................ 497  
   3.1 アクティブ物理リンクのリンク監視 ..................................... 497  
   3.2 コネクションレスペリフェラルブロードキャスト物理リンクのリンク監視 ............................................................................... 498  
   3.3 アクティブリンクの認証済みペイロードタイムアウト ............................ 498  

4. **論理トランスポート** ..................................................................................... 499  
   4.1 一般 ........................................................................................ 499  
   4.2 論理トランスポートアドレス (LT_ADDR) ........................................ 499  
   4.3 同期論理トランスポート ................................................... 500  
   4.4 非同期論理トランスポート ................................................... 500  
   4.5 送信/受信ルーチン ............................................................ 501  
      4.5.1 送信ルーチン (TX) .................................................................... 501  
      4.5.2 受信ルーチン (RX) .................................................................... 504  
      4.5.3 フロー制御 ................................................................. 505  
   4.6 アクティブペリフェラルブロードキャストトランスポート ......................................... 506  
   4.7 【このセクションは使用されていません】 ................................................... 507  
   4.8 コネクションレスペリフェラルブロードキャスト論理トランスポート ............... 507  

5. **論理リンク** .............................................................................................. 508  
   5.1 リンク制御論理リンク (LC) ....................................................... 508  
   5.2 ACL制御論理リンク (ACL-CおよびAPB-C) ............................ 508  
   5.3 ユーザー非同期/等時論理リンク (ACL‑UおよびAPB‑U) ........................................................................................ 509  
      5.3.1 ACL-U論理リンクの一時停止 .................................... 509  
   5.4 ユーザー同期データ論理リンク (SCO-S) ............................... 509  
   5.5 ユーザー拡張同期データ論理リンク (eSCO-S) ............. 509
   5.6 **論理リンクの優先順位** .................................................................... 509  
   5.7 **プロファイルブロードキャストデータ論理リンク** ................................................ 510  

6. **パケット** ...................................................................................................... 511  
   6.1 **一般フォーマット** ............................................................................ 511  
      6.1.1 **基本レート** ................................................................... 511  
      6.1.2 **拡張データレート** ................................................... 511  
   6.2 **ビットの並び順** .................................................................................. 512  
   6.3 **アクセスコード** ................................................................................ 512  
      6.3.1 **アクセスコードの種類** ....................................................... 512  
      6.3.2 **プリアンブル** ..................................................................... 513  
      6.3.3 **同期ワード** .................................................................... 513  
      6.3.4 **トレーラー** ........................................................................... 517  
   6.4 **パケットヘッダー** ............................................................................. 517  
      6.4.1 **LT_ADDR** ..................................................................... 518  
      6.4.2 **TYPE** ........................................................................... 518  
      6.4.3 **FLOW** .......................................................................... 518  
      6.4.4 **ARQN** .......................................................................... 518  
      6.4.5 **SEQN** ........................................................................... 519  
      6.4.6 **HEC** ............................................................................. 519  
   6.5 **パケットの種類** ................................................................................ 519  
      6.5.1 **共通パケットの種類** ................................................. 522  
      6.5.2 **SCOパケット** ................................................................ 524  
      6.5.3 **eSCOパケット** .............................................................. 525  
      6.5.4 **ACLパケット** ................................................................ 527  
   6.6 **ペイロードフォーマット** ............................................................................ 529  
      6.6.1 **同期データフィールド** ................................................ 530  
      6.6.2 **非同期データフィールド** .............................................. 531  
   6.7 **パケットの概要** .......................................................................... 535  

7. **ビットストリーム処理** .............................................................................. 537  
   7.1 **エラーチェック** ............................................................................. 538  
      7.1.1 **HEC生成** ........................................................... 539  
      7.1.2 **CRC生成** ........................................................... 540  
   7.2 **データホワイトニング** ............................................................................ 541  
   7.3 **エラー訂正** ............................................................................ 542  
   7.4 **FECコード: レート1/3** ...................................................................... 543  
   7.5 **FECコード: レート2/3** ...................................................................... 543  
   7.6 **ARQ方式** ............................................................................... 544  
      7.6.1 **番号なしARQ** ....................................................... 544  
      7.6.2 **再送フィルタリング** ....................................................... 548  
      7.6.3 **ペイロードのフラッシング** ........................................................ 551  
      7.6.4 **マルチペリフェラルの考慮事項** ................................... 552
      7.6.5 アクティブペリフェラルブロードキャストパケット ........................... 552  
   7.7 誤った同期データの報告 ....................................... 553  
   7.8 メッセージインテグリティチェック ............................................................. 553  

8. **リンクコントローラの動作** ......................................................................... 554  
   8.1 **状態の概要** ....................................................................... 554  
   8.2 **スタンバイ状態** .............................................................................. 555  
   8.3 **接続確立サブステート** .......................................... 555  
      8.3.1 ページスキャンサブステート .................................................... 555  
      8.3.2 ページサブステート .............................................................. 557  
      8.3.3 ページ応答サブステート ............................................ 559  
   8.4 **デバイス探索サブステート** ......................................................... 564  
      8.4.1 問い合わせスキャンサブステート .................................................. 565  
      8.4.2 問い合わせサブステート ........................................................... 566  
      8.4.3 問い合わせ応答サブステート .......................................... 567  
   8.5 **接続状態** ......................................................................... 569  
   8.6 **アクティブモード** ................................................................................. 571  
      8.6.1 アクティブモードでのポーリング ........................................... 572  
      8.6.2 SCO ............................................................................. 572  
      8.6.3 eSCO ........................................................................... 573  
      8.6.4 ブロードキャスト方式 ....................................................... 576  
      8.6.5 役割変更 .................................................................. 577  
      8.6.6 スキャッタネット .................................................................... 579  
      8.6.7 ホップシーケンスの切り替え .............................................. 580  
      8.6.8 チャネル分類およびチャネルマップ選択 ...... 583  
      8.6.9 電力管理 .................................................... 584  
      8.6.10 ピコネットクロック調整 ............................................. 585  
      8.6.11 スロット可用性マスク (SAM) ........................................ 588  
   8.7 **スニッフモード** ................................................................................... 595  
      8.7.1 スニッフ遷移モード ................................................... 597  
      8.7.2 スニッフサブレーティング .............................................................. 597  
   8.8 **ホールドモード** ................................................................................... 599  
   8.9 【このセクションは使用されていません】 ................................................... 599  
   8.10 **コネクションレスペリフェラルブロードキャストモード** ............................... 599  
      8.10.1 コネクションレスペリフェラルブロードキャスト送信動作 ...................................................................... 600  
      8.10.2 コネクションレスペリフェラルブロードキャスト受信動作 ...................................................................... 601  
      8.10.3 コネクションレスペリフェラルブロードキャストにおけるAFH ............. 602  
   8.11 **同期確立サブステート** ................................... 602  
      8.11.1 同期スキャンサブステート ................................... 602  
      8.11.2 同期トレインサブステート ................................... 602

9. **オーディオ** .......................................................................................................... 606  
   9.1 **LOG PCMコーデック** ......................................................................... 606  
   9.2 **CVSDコーデック** ................................................................................ 606  
   9.3 **エラーハンドリング** .............................................................................. 609  
   9.4 **一般的なオーディオ要件** ........................................................ 609  
      9.4.1 **信号レベル** ................................................................. 609  
      9.4.2 **CVSDオーディオ品質** ..................................................... 609  

### 付録 A 一般的なオーディオ推奨事項 .................................................. 610  
   A.1 **最大音圧** ........................................................... 610  
   A.2 【このセクションは使用されていません】 ................................................... 610  
   A.3 **Bluetooth用のオーディオレベル** ........................................................... 610  
   A.4 **マイクパス** ......................................................................... 611  
   A.5 **スピーカーパス** ....................................................................... 611  
   A.6 **Bluetooth音声インターフェイス** ............................................................. 611  
   A.7 **周波数マスク** .......................................................................... 612  

### 付録 B タイマー ............................................................................................... 614  
   B.1 **タイマーの一覧** ................................................................................ 614  
      B.1.1 **inquiryTO** ..................................................................... 614  
      B.1.2 **pageTO** ........................................................................ 614  
      B.1.3 **extended_pageTO** ....................................................... 614  
      B.1.4 **pagerespTO** ................................................................. 614  
      B.1.5 **newconnectionTO** ........................................................ 614  
      B.1.6 **supervisionTO** .............................................................. 615  
      B.1.7 **CPB_supervisionTO** .................................................... 615  
      B.1.8 **synchronization_trainTO** .............................................. 615  
      B.1.9 **synchronization_scanTO** ............................................. 615  
      B.1.10 **authenticatedPayloadTO** ............................................. 616  
      B.1.11 **CLK_adj_dragTO** ......................................................... 616  

### 付録 C ホールド、スニッフ、およびコネクションレスペリフェラルブロードキャストモードにおけるAFH動作の推奨事項 .............................. 617  
   C.1 **セントラルでの動作** .............................................................. 617  
   C.2 【このセクションは使用されていません】 ................................................... 618  
   C.3 **スニッフモードにおけるAFH動作** ....................................................... 618  
   C.4 **ホールドモードにおけるAFH動作** ....................................................... 618  
   C.5 **コネクションレスペリフェラルブロードキャストにおけるAFH動作** ............. 618  

# Part C  
## リンクマネージャプロトコル仕様

1. **はじめに** ............................................................................................... 625
2. **一般的なルール** ............................................................................................. 626  
   2.1 **メッセージトランスポート** ...................................................................... 626  
   2.2 **同期** ........................................................................... 626  
   2.3 **パケットフォーマット** .............................................................................. 627  
   2.4 **トランザクション** ................................................................................ 628  
      2.4.1 **LMP応答タイムアウト** ................................................. 628  
   2.5 **エラーハンドリング** .............................................................................. 629  
      2.5.1 **トランザクション衝突の解決** .................................... 630  
   2.6 **手順のルール** ........................................................................... 630  
   2.7 **一般応答メッセージ** ...................................................... 631  
   2.8 **LMPメッセージの制約** ........................................................... 631  

3. **デバイスの機能** ......................................................................................... 632  
   3.1 **一般的な説明** ..................................................................... 632  
   3.2 **機能の定義** ....................................................................... 632  
   3.3 **機能マスクの定義** ............................................................... 637  
   3.4 **リンクマネージャの相互運用ポリシー** ............................................ 640  
   3.5 **機能の要件** .................................................................. 640  
      3.5.1 【このセクションは使用されていません】 ................................... 643  
      3.5.2 【このセクションは使用されていません】 ................................... 643  

4. **手順のルール** ........................................................................................ 644  
   4.1 **接続制御** ...................................................................... 644  
      4.1.1 **接続確立** ........................................... 644  
      4.1.2 **切断** ......................................................................... 645  
      4.1.3 **電力制御** ............................................................... 646  
      4.1.4 **アダプティブ周波数ホッピング** ........................................ 649  
      4.1.5 **チャネル分類** .................................................. 652  
      4.1.6 **リンク監視** ........................................................... 654  
      4.1.7 **チャネル品質駆動データレート変更 (CQDDR)** .... 655  
      4.1.8 **サービス品質 (QoS)** ............................................... 656  
      4.1.9 **ページングスキームパラメータ** ......................................... 657  
      4.1.10 **マルチスロットパケットの制御** ........................................ 658  
      4.1.11 **拡張データレート** ................................................... 659  
      4.1.12 **カプセル化されたLMP PDU** ............................................ 660  
      4.1.13 **Ping** .............................................................................. 662  
      4.1.14 **ピコネットクロックの調整** ............................................. 663  
      4.1.15 **スロット可用性マスク** ................................................... 667  

   4.2 **セキュリティ** ....................................................................................... 671  
      4.2.1 **認証** .............................................................. 671  
      4.2.2 **ペアリング** .......................................................................... 674  
      4.2.3 **リンクキーの変更** ........................................................... 677  
      4.2.4 **現在のリンクキータイプの変更** ....................................... 678
      4.2.5 **暗号化** .................................................................... 679  
      4.2.6 **サポートされている暗号鍵サイズのリクエスト** ....................... 689  
      4.2.7 **セキュアシンプルペアリング** ................................................. 690  

4.3 **情報リクエスト** ................................................................. 703  
   4.3.1 **タイミング精度** ........................................................... 703  
   4.3.2 **クロックオフセット** .................................................................. 704  
   4.3.3 **LMPバージョン** ................................................................. 705  
   4.3.4 **サポートされている機能** ...................................................... 706  
   4.3.5 **名前のリクエスト** .............................................................. 707  

4.4 **役割変更** .................................................................................. 708  
   4.4.1 **スロットオフセット** ..................................................................... 708  
   4.4.2 **役割変更** .................................................................. 709  

4.5 **動作モード** ..................................................................... 712  
   4.5.1 **ホールドモード** ................................................................... 712  
   4.5.2 【このセクションは使用されていません】 ................................... 714  
   4.5.3 **スニッフモード** .................................................................... 714  

4.6 **論理トランスポート** ........................................................................ 718  
   4.6.1 **SCO論理トランスポート** ................................................... 718  
   4.6.2 **eSCO論理トランスポート** ................................................. 721  

4.7 **テストモード** .................................................................................... 726  
   4.7.1 **テストモードの有効化と無効化** .................... 726  
   4.7.2 **テストモードの制御** .................................................... 727  
   4.7.3 **テストモードPDUの概要** ..................................... 728  

5. **まとめ** ................................................................................................... 731  
   5.1 **PDUの概要** ............................................................................. 731  
   5.2 **パラメータ定義** .................................................................. 739  
   5.3 **LMPカプセル化** ...................................................................... 750  
   5.4 **デフォルト値** ............................................................................. 750  

### 付録 A パラメータ名の変更 ........................................................ 752  

# Part D  
【このパートは使用されていません】

# Part E  
【このパートは使用されていません】

# Part F  
## メッセージシーケンスチャート

1. **はじめに** ............................................................................................... 761  
   1.1 **表記法** ....................................................................................... 761
   1.2 **フロー制御** ............................................................................. 762  
   1.3 **MSCの例** ............................................................................. 762  
   1.4 **将来の互換性** .................................................................. 762  

2. **接続リクエストなしのサービス** ..................................................... 764  
   2.1 **リモートネームリクエスト** ............................................................... 764  
   2.2 **一回限りの問い合わせ** .......................................................................... 766  
   2.3 **定期的な問い合わせ** ............................................................................ 768  

3. **ACL接続の確立と切断** ................................... 771  
   3.1 **接続設定** ........................................................................ 773  

4. **ACL接続確立後のオプション活動** ...................... 781  
   4.1 **認証リクエスト** ............................................................ 781  
   4.2 **セキュアシンプルペアリングメッセージシーケンスチャート** ...................... 783  
      4.2.1 **オプションのOOB情報収集** ........................... 784  
      4.2.2 **セキュアシンプルペアリングとセキュア接続の有効化** ................................. 785  
      4.2.3 **接続確立** ........................................... 786  
      4.2.4 **セキュアサービス用のL2CAP接続リクエスト** ......... 786  
      4.2.5 **オプションのOOB情報転送** .............................. 787  
      4.2.6 **セキュアシンプルペアリングの開始** ........................................ 787  
      4.2.7 **IO能力交換** ................................................ 789  
      4.2.8 **公開鍵交換** .................................................... 789  
      4.2.9 **認証** .............................................................. 790  
      4.2.10 **数値比較** ................................................... 791  
      4.2.11 **イニシエータ側での数値比較の失敗** ............. 792  
      4.2.12 **応答側での数値比較の失敗** ......... 793  
      4.2.13 **パスキー入力** .............................................................. 793  
      4.2.14 **応答側でのパスキー入力失敗** ................... 795  
      4.2.15 **イニシエータ側でのパスキー入力失敗** .......................... 796  
      4.2.16 **アウトオブバンド (OOB)** .................................................................. 797  
      4.2.17 **イニシエータ側でのOOB失敗** ......................................... 799  
      4.2.18 **DHKeyチェック** ............................................................. 799  
      4.2.19 **リンクキーの計算** ......................................................... 801  
      4.2.20 **暗号化の有効化** ........................................................ 802  
      4.2.21 **L2CAP接続応答** ....................................... 802  
      4.2.22 **LMP Ping** ...................................................................... 803  
   4.3 **リンク監視タイムアウト変更イベント** ................................... 805  
   4.4 **接続暗号化の設定** .......................................................... 806  
   4.5 **接続リンクキーの変更** ........................................................ 808  
   4.6 **暗号化の一時停止と再開を伴う接続リンクキーの変更** 808  
   4.7 **一時リンクキー** .................................................................... 810
   4.8 **リモートサポート機能の読み取り** ................................................ 811  
   4.9 **リモート拡張機能の読み取り** .................................................. 812  
   4.10 **クロックオフセットの読み取り** ......................................................................... 813  
   4.11 **暗号化の一時停止と再開を使用した暗号化リンクでの役割変更** ................................................................................. 814  
   4.12 **暗号化キーの更新** ......................................................... 816  
   4.13 **リモートバージョン情報の読み取り** ................................................ 817  
   4.14 **QoS設定** ................................................................................... 818  
   4.15 **役割変更** ................................................................................... 819  
   4.16 【このセクションは使用されていません】 ................................................... 821  
   4.17 【このセクションは使用されていません】 ................................................... 821  
   4.18 **スロット可用性マスク** ................................................................... 821  
   4.19 **LMPトランザクション衝突** ............................................................ 825  

5. **同期接続の確立と切断** ................... 826  
   5.1 **同期接続の設定** ................................................... 826  
   5.2 **強化された同期コマンドを使用した同期接続の設定** ............................................................. 833  

6. **スニッフおよびホールドモード** ............................................................................... 840  
   6.1 **スニッフモード** ................................................................................... 840  
   6.2 **ホールドモード** ................................................................................... 841  
   6.3 【このセクションは使用されていません】 ................................................... 843  

7. **バッファ管理、フロー制御** ............................................................ 844  

8. **ループバックモード** ........................................................................................ 846  
   8.1 **ローカルループバックモード** ................................................................. 846  
   8.2 **リモートループバックモード** ............................................................. 848  

9. **コネクションレスペリフェラルブロードキャストサービス** .................................... 850  

# Part G  
## サンプルデータ

1. **暗号化サンプルデータ** ........................................................................... 857  
   1.1 **E0暗号化サンプルデータ** .......................................................... 857  
      1.1.1 **K_encからK_sessionの生成** .............................. 857  
      1.1.2 **最初のサンプルデータセット** ............................................... 860  
      1.1.3 **2番目のサンプルデータセット** .......................................... 870  
      1.1.4 **3番目のサンプルセット** .................................................... 880  
      1.1.5 **4番目のサンプルセット** .................................................. 890  
   1.2 **AES-CCM暗号化サンプルデータ** ............................................. 900  
      1.2.1 **サンプルデータ1 (DM1, セントラル → ペリフェラル)** ............... 900
      1.2.2 **サンプルデータ2 (DM1, セントラル → ペリフェラル)** ............... 901  
      1.2.3 **サンプルデータ3 (DM1, ペリフェラル → セントラル)** ............... 902  
      1.2.4 **サンプルデータ4 (DM1, セントラル → ペリフェラル)** ............... 903  
      1.2.5 **サンプルデータ5 (DM1, ペリフェラル → セントラル)** ............... 904  
      1.2.6 **サンプルデータ6 (DH1, セントラル → ペリフェラル)** ............... 905  
      1.2.7 **サンプルデータ7 (DH1, ペリフェラル → セントラル)** ............... 906  
      1.2.8 **サンプルデータ8 (DH1, セントラル → ペリフェラル)** ............... 907  
      1.2.9 **サンプルデータ9 (DH1, ペリフェラル → セントラル)** ............... 908  
      1.2.10 **サンプルデータ10 (2-DH3, セントラル → ペリフェラル)** .......... 909  
      1.2.11 **サンプルデータ11 (2-DH3, ペリフェラル → セントラル)** .......... 913  
      1.2.12 **サンプルデータ12 (3-DH5, セントラル → ペリフェラル)** .......... 917  
      1.2.13 **サンプルデータ13 (3-DH5, ペリフェラル → セントラル)** .......... 927  
      1.2.14 **サンプルデータ14 (EV3)** ................................................. 937  

2. **周波数ホッピングサンプルデータ** ............................................................. 938  
   2.1 **最初のセット** ........................................................................................ 938  
   2.2 **2番目のセット** .................................................................................. 944  
   2.3 **3番目のセット** ...................................................................................... 950  

3. **アクセスコードサンプルデータ** ........................................................................ 957  

4. **HECおよびパケットヘッダーのサンプルデータ** ...................................................... 960  

5. **CRCサンプルデータ** ...................................................................................... 961  

6. **完全なサンプルパケット** ........................................................................ 962  
   6.1 **DH1パケットの例** .............................................................. 962  
   6.2 **DM1パケットの例** .............................................................. 964  

7. **セキュアシンプルペアリングサンプルデータ** ........................................................ 966  
   7.1 **楕円曲線サンプルデータ** ........................................................... 966  
      7.1.1 **P-192サンプルデータ** ...................................................... 966  
      7.1.2 **P-256サンプルデータ** ...................................................... 967  
   7.2 **ハッシュ関数サンプルデータ** ........................................................ 968  
      7.2.1 **f1()** ............................................................................... 968  
      7.2.2 **g()** ................................................................................ 970  
      7.2.3 **f2()** ............................................................................... 970  
      7.2.4 **f3()** ............................................................................... 971  
      7.2.5 【このセクションは使用されていません】 ................................... 977  
      7.2.6 **h4()** .............................................................................. 977  
      7.2.7 **h5()** .............................................................................. 978  
      7.2.8 **h3()** .............................................................................. 978  

8. **ホワイトニングシーケンスサンプルデータ** ........................................................... 979
9. **FECサンプルデータ** ....................................................................................... 982  

10. **暗号化キーのサンプルデータ** .................................................................... 983  
   10.1 **E1の4つのテスト** ........................................................................... 983  
   10.2 **E21の4つのテスト** ......................................................................... 988  
   10.3 **E22の3つのテスト** ....................................................................... 991  
   10.4 **ピン拡張によるE22のテスト** ............................................... 993  
   10.5 **E3の4つのテスト** ......................................................................... 1004  

11. **コネクションレスペリフェラルブロードキャストサンプルデータ** ............................ 1009  

# Part H  
## セキュリティ仕様  

1. **セキュリティ概要** ................................................................................... 1014  
   1.1 **暗号化の一時停止と役割変更** ........................................... 1015  
   1.2 **接続リンクキーの変更** .................................................... 1015  
   1.3 **暗号化キーの定期更新** ..................................... 1016  

2. **乱数生成** .................................................................. 1017  

3. **キー管理** .................................................................................... 1019  
   3.1 **キーの種類** ................................................................................... 1019  
   3.2 **キーの生成と初期化** ............................................... 1021  
      3.2.1 **初期化キーKinitの生成** ........................... 1021  
      3.2.2 **認証** ............................................................ 1022  
      3.2.3 【このセクションは使用されていません】 ................................. 1022  
      3.2.4 **結合キーの生成** ............................... 1022  
      3.2.5 **暗号化キーの生成** ................................... 1024  
      3.2.6 **ポイントツーマルチポイント構成** ................................ 1024  
      3.2.7 **リンクキーの変更** ............................................... 1025  
      3.2.8 **一時リンクキーの生成** ................................ 1025  

4. **暗号化 (E0)** ....................................................................................... 1027  
   4.1 **暗号化キーサイズのネゴシエーション** ................................................. 1027  
   4.2 **ブロードキャストメッセージの暗号化** ........................................... 1028  
   4.3 **暗号化の概念** .................................................................... 1028  
   4.4 **暗号化アルゴリズム** ................................................................. 1029  
      4.4.1 **暗号の動作** ........................................ 1031  
   4.5 **LFSRの初期化** ..................................................................... 1032  
   4.6 **キーのストリームシーケンス** ............................................................... 1035  

5. **認証** ......................................................................................... 1036  
   5.1 **繰り返しの試行** .................................................................... 1039

6. **認証と鍵生成の関数** ............................... 1040  
   6.1 **認証関数 E1** .................................................. 1040  
   6.2 **関数 Ar および A'r** ............................................................. 1042  
      6.2.1 **ラウンド計算** ............................................ 1043  
      6.2.2 **代替ボックス「e」と「l」** .............................. 1043  
      6.2.3 **キーのスケジューリング** .......................................................... 1045  
   6.3 **認証用E2鍵生成関数** ........................... 1045  
   6.4 **暗号化用E3鍵生成関数** ................................. 1047  

7. **セキュアシンプルペアリング** ............................................................................ 1049  
   7.1 **フェーズ1: 公開鍵交換** .................................................. 1050  
   7.2 **フェーズ2: 認証ステージ1** ............................................... 1051  
      7.2.1 **認証ステージ1: 数値比較プロトコル** 1051  
      7.2.2 **認証ステージ1: アウトオブバンドプロトコル** ............ 1053  
      7.2.3 **認証ステージ1: パスキー入力プロトコル** ........ 1055  
   7.3 **フェーズ3: 認証ステージ2** ............................................... 1057  
   7.4 **フェーズ4: リンクキー計算** .................................................... 1058  
   7.5 **フェーズ5: LMP認証と暗号化** ............................ 1059  
   7.6 **楕円曲線の定義** ............................................................... 1059  
   7.7 **暗号化関数の定義** ............................................. 1060  
      7.7.1 **セキュアシンプルペアリングのコミットメント関数f1** .. 1060  
      7.7.2 **セキュアシンプルペアリングの数値検証関数g** ........... 1061  
      7.7.3 **セキュアシンプルペアリングの鍵導出関数f2** ........... 1062  
      7.7.4 **セキュアシンプルペアリングのチェック関数f3** .......... 1063  
      7.7.5 【このセクションは使用されていません】 ................................. 1064  
      7.7.6 **AES暗号化キー生成関数h3** ....... 1064  
      7.7.7 **デバイス認証キー生成関数h4** 1065  
      7.7.8 **デバイス認証確認関数h5** .. 1065  

8. 【このセクションは使用されていません】 ............................................................ 1067  

9. **BR/EDR用AES-CCM暗号化** ......................................................... 1068  
   9.1 **ナンス形式** ........................................................................... 1068  
   9.2 **カウンタモードブロック** ................................................................ 1070  
   9.3 **暗号化ブロック** ...................................................................... 1071  
   9.4 **暗号化キーサイズの縮小** ................................................... 1072  
   9.5 **繰り返し発生するMICエラー** .............................................................. 1072

# Host  
## 仕様書 Volume 3  

### Part A  
### 論理リンク制御および適応プロトコル仕様  

1. **はじめに** ............................................................................................. 1080  
   1.1 **L2CAPの機能** ......................................................................... 1080  
   1.2 **前提条件** .............................................................................. 1083  
   1.3 **適用範囲** ........................................................................................ 1084  
   1.4 **用語** ............................................................................... 1084  

2. **一般動作** ................................................................................... 1088  
   2.1 **チャネル識別子** .................................................................... 1088  
   2.2 **デバイス間の動作** ....................................................... 1091  
   2.3 **層間の動作** ......................................................... 1092  
   2.4 **動作モード** ................................................................... 1093  
   2.5 **論理リンクへのチャネルのマッピング** .............................................. 1095  

3. **データパケットフォーマット** ................................................................................. 1096  
   3.1 **基本L2CAPモードでの接続指向チャネル** .............. 1096  
   3.2 **基本L2CAPモードでのコネクションレスデータチャネル** ................ 1097  
   3.3 **再送/フロー制御/ストリーミングモードでの接続指向チャネル** ......................................................... 1098  
      3.3.1 **L2CAPヘッダーフィールド** .................................................. 1098  
      3.3.2 **制御フィールド** ................................................................ 1099  
      3.3.3 **L2CAP SDU長フィールド（2オクテット）** ........................... 1103  
      3.3.4 **情報ペイロードフィールド** ........................................... 1103  
      3.3.5 **フレームチェックシーケンス（2オクテット）** ............................ 1103  
      3.3.6 **無効フレーム検出（再送およびフロー制御モード）** .................................................. 1104  
      3.3.7 **無効フレーム検出アルゴリズム** ............................. 1105  
   3.4 **LEクレジットベースフロー制御モードおよび拡張クレジットベースフロー制御モードでの接続指向チャネル** 1106  
      3.4.1 **L2CAPヘッダーフィールド** ................................................. 1106  
      3.4.2 **L2CAP SDU長フィールド（2オクテット）** ........................... 1107  
      3.4.3 **情報ペイロードフィールド** ........................................... 1107  

4. **シグナリングパケットフォーマット** ....................................................................... 1108  
   4.1 **L2CAP_COMMAND_REJECT_RSP（コード0x01）** ..................... 1111  
   4.2 **L2CAP_CONNECTION_REQ（コード0x02）** ............................... 1112  
   4.3 **L2CAP_CONNECTION_RSP（コード0x03）** ............................... 1113
   4.4 **L2CAP_CONFIGURATION_REQ（コード0x04）** ......................... 1115  
   4.5 **L2CAP_CONFIGURATION_RSP（コード0x05）** .......................... 1117  
   4.6 **L2CAP_DISCONNECTION_REQ（コード0x06）** ......................... 1120  
   4.7 **L2CAP_DISCONNECTION_RSP（コード0x07）** ......................... 1120  
   4.8 **L2CAP_ECHO_REQ（コード0x08）** ............................................. 1121  
   4.9 **L2CAP_ECHO_RSP（コード0x09）** ............................................. 1121  
   4.10 **L2CAP_INFORMATION_REQ（コード0x0A）** .............................. 1122  
   4.11 **L2CAP_INFORMATION_RSP（コード0x0B）** .............................. 1123  
   4.12 **拡張機能マスク** ............................................................ 1124  
   4.13 **BR/EDRでサポートされる固定チャネル** ................................. 1125  
   4.14 【このセクションは使用されていません】 ................................................. 1126  
   4.15 【このセクションは使用されていません】 ................................................. 1126  
   4.16 【このセクションは使用されていません】 ................................................. 1126  
   4.17 【このセクションは使用されていません】 ................................................. 1126  
   4.18 【このセクションは使用されていません】 ................................................. 1126  
   4.19 【このセクションは使用されていません】 ................................................. 1126  
   4.20 **L2CAP_CONNECTION_PARAMETER_UPDATE_REQ（コード0x12）** ............................................................................... 1126  
   4.21 **L2CAP_CONNECTION_PARAMETER_UPDATE_RSP（コード0x13）** ............................................................................... 1127  
   4.22 **L2CAP_LE_CREDIT_BASED_CONNECTION_REQ（コード0x14）** ......................................................................................... 1128  
   4.23 **L2CAP_LE_CREDIT_BASED_CONNECTION_RSP（コード0x15）** ......................................................................................... 1129  
   4.24 **L2CAP_FLOW_CONTROL_CREDIT_IND（コード0x16）** ........... 1131  
   4.25 **L2CAP_CREDIT_BASED_CONNECTION_REQ（コード0x17）** . 1132  
   4.26 **L2CAP_CREDIT_BASED_CONNECTION_RSP（コード0x18）** .. 1133  
   4.27 **L2CAP_CREDIT_BASED_RECONFIGURE_REQ（コード0x19）** 1135  
   4.28 **L2CAP_CREDIT_BASED_RECONFIGURE_RSP（コード0x1A）** 1136  

5. **構成パラメータオプション** .......................................................... 1137  
   5.1 **最大送信単位（MTU）** .......................................... 1137  
   5.2 **フラッシュタイムアウトオプション** ................................................................. 1139  
   5.3 **サービス品質（QoS）オプション** ................................................. 1140  
   5.4 **再送およびフロー制御オプション** .................................. 1144  
   5.5 **フレームチェックシーケンス（FCS）オプション** ...................................... 1149  
   5.6 **拡張フロー仕様オプション** .......................................... 1150  
   5.7 **拡張ウィンドウサイズオプション** .................................................. 1155  

6. **状態マシン** ......................................................................................... 1157  
   6.1 **状態マシンの一般ルール** .......................................... 1157  
      6.1.1 **CLOSED状態** ........................................................... 1158  
      6.1.2 **WAIT_CONNECT_RSP状態** .................................... 1159
      6.1.3 **WAIT_CONNECT状態** ............................................. 1160  
      6.1.4 **CONFIG状態** ............................................................ 1160  
      6.1.5 **OPEN状態** ................................................................ 1165  
      6.1.6 **WAIT_DISCONNECT状態** ....................................... 1166  
      6.1.7 【このセクションは使用されていません】 ................................. 1166  
      6.1.8 【このセクションは使用されていません】 ................................. 1166  
      6.1.9 【このセクションは使用されていません】 ................................. 1166  
      6.1.10 【このセクションは使用されていません】 ................................. 1166  
      6.1.11 【このセクションは使用されていません】 ................................. 1166  
      6.1.12 【このセクションは使用されていません】 ................................. 1166  

   6.2 **タイマーイベント** ............................................................................ 1166  
      6.2.1 **RTX** ............................................................................ 1166  
      6.2.2 **ERTX** ......................................................................... 1167  

7. **一般手順** ................................................................................ 1170  
   7.1 **構成プロセス** ............................................................... 1170  
      7.1.1 **リクエストパス** ............................................................. 1171  
      7.1.2 **レスポンスパス** .......................................................... 1172  
      7.1.3 **ロックステップ構成プロセス** ................................ 1172  
      7.1.4 **標準構成プロセス** ................................ 1175  
   7.2 **断片化と再結合** ............................................ 1177  
      7.2.1 **L2CAP PDUの断片化** ................................. 1177  
      7.2.2 **L2CAP PDUの再結合** ................................ 1178  
   7.3 **SDUのカプセル化** ............................................................. 1179  
      7.3.1 **L2CAP SDUのセグメンテーション** .................................. 1179  
      7.3.2 **L2CAP SDUの再構成** .................................... 1180  
      7.3.3 **セグメンテーションと断片化** .............................. 1180  
   7.4 **誤ったL2CAP SDUの配信** ......................................... 1181  
   7.5 **ACL-U論理リンクでのフラッシング有効時の動作** ......................... 1182  
   7.6 **コネクションレスデータチャネル** .................................................... 1183  
   7.7 **操作衝突の解決** .................................................... 1185  
   7.8 【このセクションは使用されていません】 ................................................. 1185  
   7.9 **HCI上のデータ優先順位付け** .......................................................... 1185  
   7.10 **BR/EDRおよびBR/EDR/LEコントローラ向けの拡張フロー仕様のサポート** ............................................................. 1185  
   7.11 **拡張クレジットベースフロー制御再構成** ............. 1187  

8. **フロー制御および再送信の手順** .............................. 1188  
   8.1 **情報の取得** .................................................................. 1188  
   8.2 **フロー制御および再送信のためのPDUタイプの機能** .. 1188  
      8.2.1 **情報フレーム（Iフレーム）** ........................................ 1188  
      8.2.2 **監督フレーム（Sフレーム）** ..................................... 1188  
   8.3 **変数およびシーケンス番号** ............................................. 1189
      8.3.1 **送信ピア** ............................................................. 1190  
      8.3.2 **受信ピア** ........................................................... 1191  
   8.4 **再送モード** ............................................................... 1193  
      8.4.1 **フレームの送信** ................................................... 1193  
      8.4.2 **Iフレームの受信** ..................................................... 1195  
      8.4.3 **SDU再構成機能によって引き出されたIフレーム** ...... 1195  
      8.4.4 **確認応答の送受信** ................. 1195  
      8.4.5 **REJフレームの受信** ............................................... 1197  
      8.4.6 **確認応答の待機** ......................................... 1197  
      8.4.7 **例外条件** .................................................. 1197  
   8.5 **フロー制御モード** .................................................................... 1199  
      8.5.1 **Iフレームの送信** ................................................. 1199  
      8.5.2 **Iフレームの受信** ..................................................... 1200  
      8.5.3 **SDU再構成機能によって引き出されたIフレーム** ...... 1200  
      8.5.4 **確認応答の送受信** ................. 1200  
      8.5.5 **確認応答の待機** ......................................... 1201  
      8.5.6 **例外条件** .................................................. 1201  
   8.6 **強化再送モード** .............................................. 1202  
      8.6.1 **PDUタイプの機能** ............................................... 1203  
      8.6.2 **タイマーに関するルール** .......................................................... 1204  
      8.6.3 **状態マシンの一般ルール** .......................... 1205  
      8.6.4 **状態図** ............................................................ 1206  
      8.6.5 **状態テーブル** .............................................................. 1207  
   8.7 **ストリーミングモード** ........................................................................ 1231  
      8.7.1 **Iフレームの送信** ................................................. 1231  
      8.7.2 **Iフレームの受信** ..................................................... 1231  
      8.7.3 **例外条件** .................................................. 1232  

9 【このセクションは使用されていません】 ............................................................ 1233  

10 **クレジットベースフロー制御の手順** .......................................... 1234  
   10.1 **LEクレジットベースフロー制御モード** ......................................... 1234  
   10.2 **強化クレジットベースフロー制御モード** ............................. 1235  

### 付録 A **構成MSC** ...................................................................... 1236  
### 付録 B **シグナリングパケット名の変更** ........................................... 1239  

# Part B  
## サービスディスカバリプロトコル（SDP）仕様

1. **はじめに** ............................................................................................. 1244  
   1.1 **一般説明** ................................................................... 1244  
   1.2 【このセクションは使用されていません】 ................................................. 1244
   1.3 【このセクションは使用されていません】 ................................................. 1244  
   1.4 【このセクションは使用されていません】 ................................................. 1244  
   1.5 **規約** .............................................................................. 1244  
      1.5.1 **ビットおよびバイトの並び順に関する規約** ............................. 1244  

2. **概要** .................................................................................................. 1245  
   2.1 **SDPクライアント-サーバーアーキテクチャ** ................................................. 1245  
   2.2 **サービスレコード** ........................................................................... 1246  
   2.3 **サービス属性** ........................................................................ 1247  
      2.3.1 **属性ID** ................................................................. 1248  
      2.3.2 **属性値** ............................................................ 1248  
   2.4 **サービスクラス** ............................................................................. 1248  
      2.4.1 **プリンタサービスクラスの例** ................................. 1249  
   2.5 **サービスの検索** ............................................................... 1249  
      2.5.1 **UUID** .......................................................................... 1250  
      2.5.2 **サービス検索パターン** ............................................. 1250  
   2.6 **サービスのブラウジング** ................................................................ 1251  
      2.6.1 **サービスブラウジング階層の例** ......................... 1251  

3. **データ表現** ................................................................................ 1254  
   3.1 **データ要素** ............................................................................. 1254  
   3.2 **データ要素タイプ記述子** .................................................... 1254  
   3.3 **データ要素サイズ記述子** ..................................................... 1255  
   3.4 **データ要素の例** ............................................................ 1256  

4. **プロトコルの説明** ............................................................................... 1257  
   4.1 **転送バイト順序** .................................................................... 1257  
   4.2 **プロトコルデータユニット（PDU）形式** .......................................................... 1257  
   4.3 **部分的な応答と継続状態** .................................. 1258  
   4.4 **エラーハンドリング** ............................................................................ 1259  
      4.4.1 **SDP_ERROR_RSP PDU** .......................................... 1260  
   4.5 **サービス検索トランザクション** ....................................................... 1260  
      4.5.1 **SDP_SERVICE_SEARCH_REQ PDU** ...................... 1261  
      4.5.2 **SDP_SERVICE_SEARCH_RSP PDU** ....................... 1262  
   4.6 **サービス属性トランザクション** ..................................................... 1263  
      4.6.1 **SDP_SERVICE_ATTR_REQ PDU** ............................ 1264  
      4.6.2 **SDP_SERVICE_ATTR_RSP PDU** ............................ 1265  
   4.7 **サービス検索属性トランザクション** ......................................... 1266  
      4.7.1 **SDP_SERVICE_SEARCH_ATTR_REQ PDU** ........... 1267  
      4.7.2 **SDP_SERVICE_SEARCH_ATTR_RSP PDU** ........... 1269  

5. **サービス属性定義** ................................................................... 1271  
   5.1 **ユニバーサル属性定義** .................................................... 1271  
      5.1.1 **ServiceRecordHandle属性** .................................. 1271
      5.1.2 **ServiceClassIDList属性** ....................................... 1272  
      5.1.3 **ServiceRecordState属性** ..................................... 1272  
      5.1.4 **ServiceID属性** ..................................................... 1272  
      5.1.5 **ProtocolDescriptorList属性** ................................. 1273  
      5.1.6 **AdditionalProtocolDescriptorLists属性** ................ 1274  
      5.1.7 **BrowseGroupList属性** ......................................... 1275  
      5.1.8 **LanguageBaseAttributeIDList属性** ...................... 1275  
      5.1.9 **ServiceInfoTimeToLive属性** ................................ 1276  
      5.1.10 **ServiceAvailability属性** ........................................ 1276  
      5.1.11 **BluetoothProfileDescriptorList属性** ..................... 1277  
      5.1.12 **DocumentationURL属性** ..................................... 1278  
      5.1.13 **ClientExecutableURL属性** .................................. 1278  
      5.1.14 **IconURL属性** ....................................................... 1278  
      5.1.15 **ServiceName属性** ............................................... 1279  
      5.1.16 **ServiceDescription属性** ....................................... 1279  
      5.1.17 **ProviderName属性** .............................................. 1280  
      5.1.18 【このセクションは使用されていません】 ................................. 1280  

   5.2 **ServiceDiscoveryServerサービスクラス属性定義** ....... 1280  
      5.2.1 **ServiceRecordHandle属性** .................................. 1280  
      5.2.2 **ServiceClassIDList属性** ....................................... 1280  
      5.2.3 **VersionNumberList属性** ...................................... 1281  
      5.2.4 **ServiceDatabaseState属性** ................................. 1281  
      5.2.5 【このセクションは使用されていません】 ................................. 1281  

   5.3 **BrowseGroupDescriptorサービスクラス属性定義** ....... 1281  
      5.3.1 **ServiceClassIDList属性** ....................................... 1282  
      5.3.2 **GroupID属性** ....................................................... 1282  
      5.3.3 【このセクションは使用されていません】 ................................. 1282  

6. **セキュリティ** .................................................................................................... 1283  

### 付録 A 【この付録は使用されていません】 ............................................... 1284  

### 付録 B **SDPトランザクションの例** .......................................................... 1285  
   B.1 **SDPの例1 – ServiceSearchRequest** ................................ 1285  
   B.2 **SDPの例2 – ServiceAttributeTransaction** ......................... 1287  
   B.3 **SDPの例3 – ServiceSearchAttributeTransaction** .............. 1292  

### 付録 C **PDU名の変更** ................................................................ 1303  

# Part C  
## ジェネリックアクセスプロファイル（GAP）

1. **序文** .................................................................................................. 1315  
   1.1 **適用範囲** ........................................................................................ 1315
   1.2 **記号および規約** ......................................................... 1316  
      1.2.1 【このセクションは使用されていません】 ................................. 1316  
      1.2.2 **シグナリングダイアグラムの規約** .................................. 1316  
      1.2.3 **タイマーおよびカウンターの表記** ............................... 1317  
      1.2.4 **UUIDの表記** ..................................................... 1317  

   1.3 **GAP要件** ..................................................................... 1317  

2. **プロファイル概要** ...................................................................................... 1318  
   2.1 **プロファイルスタック** ............................................................................... 1318  
   2.2 **プロファイルの役割** ............................................................................... 1318  
      2.2.1 **BR/EDR物理トランスポート上で動作する際の役割** ................................... 1318  
      2.2.2 **LE物理トランスポート上で動作する際の役割** 1319  
   2.3 **ユーザー要件およびシナリオ** ............................................. 1322  
   2.4 **プロファイルの基本原則** ................................................................. 1322  
   2.5 【このセクションは使用されていません】 ................................................. 1323  

3. **ユーザーインターフェースの側面** ........................................................................... 1324  
   3.1 **ユーザーインターフェースレベル** ............................................................. 1324  
   3.2 **Bluetoothパラメータの表現** .................................. 1324  
      3.2.1 **Bluetoothデバイスアドレス（BD_ADDR）** ..................... 1324  
      3.2.2 **Bluetoothデバイス名（ユーザーフレンドリーネーム）** ...... 1324  
      3.2.3 **Bluetoothパスキー（Bluetooth PIN）** ........................... 1325  
      3.2.4 **デバイスクラス** .......................................................... 1327  
      3.2.5 **アピアランス特性** ......................................... 1328  
      3.2.6 **ブロードキャストコード** ......................................................... 1328  
   3.3 **ペアリング** ....................................................................................... 1329  

4. **モード - BR/EDR物理トランスポート** ..................................................... 1330  
   4.1 **発見可能モード** ............................................................... 1330  
      4.1.1 **非発見可能モード** ............................................. 1331  
      4.1.2 **制限付き発見可能モード** ....................................... 1331  
      4.1.3 **一般発見可能モード** ...................................... 1332  
   4.2 **接続可能モード** ................................................................ 1333  
      4.2.1 **非接続可能モード** ............................................. 1333  
      4.2.2 **接続可能モード** .................................................... 1334  
   4.3 **ボンダブルモード** ....................................................................... 1335  
      4.3.1 **非ボンダブルモード** .................................................. 1335  
      4.3.2 **ボンダブルモード** ......................................................... 1335  
   4.4 **同期可能モード** ........................................................... 1336  
      4.4.1 **非同期可能モード** ......................................... 1336  
      4.4.2 **同期可能モード** ................................................ 1336  

5. **セキュリティの側面 - BR/EDR物理トランスポート** ................................... 1337
   5.1 **認証** ........................................................................... 1337  
      5.1.1 **目的** ..................................................................... 1337  
      5.1.2 **UIレベルでの用語** ......................................................... 1337  
      5.1.3 **手順** .................................................................. 1338  
      5.1.4 **条件** .................................................................. 1339  

   5.2 **セキュリティモード** .......................................................................... 1339  
      5.2.1 **レガシーセキュリティモード** .............................................. 1340  
      5.2.2 **セキュリティモード4（サービスレベルでの強制セキュリティ）** ..... 1341  

6. **アイドルモード手順 – BR/EDR物理トランスポート** .......................... 1358  
   6.1 **一般的な問い合わせ** .......................................................................... 1358  
      6.1.1 **目的** ..................................................................... 1358  
      6.1.2 **UIレベルでの用語** ......................................................... 1359  
      6.1.3 **説明** ................................................................. 1359  
      6.1.4 **条件** .................................................................. 1359  
   6.2 **制限付き問い合わせ** ........................................................................... 1359  
      6.2.1 **目的** ..................................................................... 1359  
      6.2.2 **UIレベルでの用語** ......................................................... 1360  
      6.2.3 **説明** ................................................................. 1360  
      6.2.4 **条件** .................................................................. 1360  
   6.3 **名前の発見** ........................................................................ 1360  
      6.3.1 **目的** ..................................................................... 1360  
      6.3.2 **UIレベルでの用語** ......................................................... 1361  
      6.3.3 **説明** ................................................................. 1361  
      6.3.4 **条件** .................................................................. 1362  
   6.4 **デバイスの発見** ....................................................................... 1362  
      6.4.1 **目的** ..................................................................... 1362  
      6.4.2 **UIレベルでの用語** ......................................................... 1362  
      6.4.3 **説明** ................................................................. 1362  
      6.4.4 **条件** .................................................................. 1363  
   6.5 **ボンディング** ..................................................................................... 1363  
      6.5.1 **目的** ..................................................................... 1363  
      6.5.2 **UIレベルでの用語** ......................................................... 1363  
      6.5.3 **説明** ................................................................. 1364  
      6.5.4 **条件** .................................................................. 1366  

7. **確立手順 – BR/EDR物理トランスポート** ................... 1367  
   7.1 **リンク確立** .................................................................... 1367  
      7.1.1 **目的** ..................................................................... 1367  
      7.1.2 **UIレベルでの用語** ......................................................... 1367  
      7.1.3 **説明** ................................................................. 1368  
      7.1.4 **条件** .................................................................. 1369  
   7.2 **チャネル確立** ............................................................. 1370
      7.2.1 **目的** ..................................................................... 1370  
      7.2.2 **UIレベルでの用語** ......................................................... 1370  
      7.2.3 **説明** ................................................................. 1370  
      7.2.4 **条件** .................................................................. 1371  

   7.3 **接続の確立** ........................................................ 1372  
      7.3.1 **目的** ..................................................................... 1372  
      7.3.2 **UIレベルでの用語** ......................................................... 1372  
      7.3.3 **説明** ................................................................. 1372  
      7.3.4 **条件** .................................................................. 1373  

   7.4 **追加接続の確立** ..................................... 1373  
   7.5 **同期の確立** ................................................. 1374  
      7.5.1 **目的** ..................................................................... 1374  
      7.5.2 **UIレベルでの用語** ........................................................ 1374  
      7.5.3 **説明** ................................................................. 1374  
      7.5.4 **条件** .................................................................. 1374  

8. **拡張問い合わせ応答データ形式** ............................................... 1376  

9. **運用モードおよび手順 – LE物理トランスポート** ............ 1378  
   9.1 **ブロードキャストモードおよび観測手順** ........................... 1378  
      9.1.1 **ブロードキャストモード** ......................................................... 1379  
      9.1.2 **観測手順** .............................................. 1379  
   9.2 **発見モードおよび手順** ............................................. 1380  
      9.2.1 **要件** ............................................................ 1380  
      9.2.2 **非発見可能モード** ............................................. 1380  
      9.2.3 **制限付き発見可能モード** ....................................... 1381  
      9.2.4 **一般発見可能モード** ...................................... 1382  
      9.2.5 **制限付き発見手順** ..................................... 1384  
      9.2.6 **一般発見手順** .................................... 1385  
      9.2.7 **名前発見手順** ....................................... 1387  
   9.3 **接続モードおよび手順** .......................................... 1387  
      9.3.1 **要件** ............................................................ 1388  
      9.3.2 **非接続可能モード** ............................................. 1389  
      9.3.3 **指向接続可能モード** ...................................... 1389  
      9.3.4 **非指向接続可能モード** .................................. 1389  
      9.3.5 **自動接続確立手順** ............... 1390  
      9.3.6 **一般接続確立手順** .......... 1392  
      9.3.7 **選択的接続確立手順** ........ 1394  
      9.3.8 **直接接続確立手順** ............. 1396  
      9.3.9 **接続パラメータ更新手順** ................. 1397  
      9.3.10 **接続終了手順** .............................. 1398  
      9.3.11 **接続確立タイミングパラメータ** .......... 1398  
      9.3.12 **接続間隔タイミングパラメータ** ...................... 1399
      9.3.13 **接続同期ストリーム セントラル確立手順** ........................................... 1401  
      9.3.14 **接続同期ストリーム ペリフェラル確立手順** ........................................... 1401  
      9.3.15 **接続同期ストリーム終了手順** ........................... 1401  
      9.3.16 **接続サブレート手順** .................................. 1402  
      9.3.17 **定期的アドバタイジング接続手順** .............. 1402  

   9.4 **ボンディングモードおよび手順** ............................................... 1402  
      9.4.1 **要件** ............................................................ 1403  
      9.4.2 **非ボンダブルモード** .................................................. 1403  
      9.4.3 **ボンダブルモード** ......................................................... 1403  
      9.4.4 **ボンディング手順** .................................................... 1403  

   9.5 **定期的アドバタイジングモードおよび手順** ............................... 1404  
      9.5.1 **定期的アドバタイジング同期可能モード** ............. 1405  
      9.5.2 **定期的アドバタイジングモード** ......................................... 1405  
      9.5.3 **定期的アドバタイジング同期確立手順** ........................................... 1406  
      9.5.4 **定期的アドバタイジング同期転送手順** ........................................... 1406  
      9.5.5 【このセクションは使用されていません】 ................................. 1406  

   9.6 **同期ブロードキャストモードおよび手順** ........................ 1407  
      9.6.1 **ブロードキャスト同期可能モード** ........ 1407  
      9.6.2 **ブロードキャスト同期送信モード** .............. 1408  
      9.6.3 **ブロードキャスト同期確立手順** ........................................... 1408  
      9.6.4 **ブロードキャスト同期チャネルマップ更新手順** ........................................... 1408  
      9.6.5 **ブロードキャスト同期終了手順** ............ 1408  

   9.7 **チャネルサウンディング手順** .................................................. 1409  
      9.7.1 **チャネルサウンディング開始手順** ....................... 1409  
      9.7.2 **チャネルサウンディング反射手順** ...................... 1409  

10. **セキュリティの側面 – LE物理トランスポート** ............................................ 1411  
   10.1 **要件** ............................................................................ 1411  
   10.2 **LEセキュリティモード** ..................................................................... 1412  
      10.2.1 **LEセキュリティモード1** .................................................... 1412  
      10.2.2 **LEセキュリティモード2** .................................................... 1412  
      10.2.3 **混合セキュリティモード要件** .......................... 1413  
      10.2.4 **セキュア接続のみモード** ................................ 1413  
      10.2.5 **LEセキュリティモード3** .................................................... 1413  

   10.3 **認証手順** .......................................................... 1414  
      10.3.1 **サービスリクエストへの応答** ............................... 1414  
      10.3.2 **サービスリクエストの開始** ......................................... 1418
   10.4 **データ署名** .............................................................................. 1422  
      10.4.1 **接続データ署名手順** .......................... 1422  
      10.4.2 **署名済みデータの認証手順** ......................... 1423  

   10.5 **認可手順** ............................................................ 1424  
   10.6 **暗号化手順** ................................................................ 1424  

   10.7 **プライバシー機能** .......................................................................... 1425  
      10.7.1 **ペリフェラルでのプライバシー機能** .................................. 1426  
      10.7.2 **セントラルでのプライバシー機能** ....................................... 1427  
      10.7.3 **ブロードキャスターでのプライバシー機能** ............................... 1428  
      10.7.4 **オブザーバーでのプライバシー機能** .................................. 1429  

   10.8 **ランダムデバイスアドレス** ........................................................... 1429  
      10.8.1 **静的アドレス** ............................................................ 1430  
      10.8.2 **プライベートアドレス** .......................................................... 1430  

   10.9 **暗号化されたブロードキャスト同期グループ** ................................. 1430  
   10.10 **暗号化されたアドバタイジングデータ手順** ..................................... 1431  

   10.11 **LEチャネルサウンディング** ............................................................... 1431  
      10.11.1 **チャネルサウンディングのセキュリティ** ........................................ 1431  

11. **アドバタイジングおよびスキャン応答データ形式** ...................................... 1432  

12. **GATTサーバー向けのGAPサービスと特性** .............................. 1434  
   12.1 **デバイス名特性** ....................................................... 1435  
   12.2 **アピアランス特性** ......................................................... 1435  
   12.3 **ペリフェラルの優先接続パラメータ特性** ..... 1436  
   12.4 **セントラルアドレス解決特性** ................................ 1437  
   12.5 **解決可能なプライベートアドレスのみの特性** ....................... 1437  
   12.6 **暗号化されたデータキー素材** .................................................... 1438  
   12.7 **LE GATTセキュリティレベル特性** ................................... 1439  

13. **BR/EDR/LE操作** ............................................................................. 1441  
   13.1 **モード、手順、およびセキュリティの側面** ................................. 1441  
      13.1.1 **発見可能モードの要件** .............................. 1441  
   13.2 **BR/EDR/LE実装のためのボンディング** ................................. 1441  
   13.3 **物理トランスポート間の関係** ................................. 1442  

14. **BR/EDR/LEセキュリティの側面** ................................................................. 1443  
   14.1 **クロストランスポートキーの導出** .................................................. 1443  
   14.2 **衝突処理** ...................................................................... 1444  
   14.3 **セキュア接続のみモード** ............................................... 1444  

15. **Bluetoothデバイス要件** ............................................................. 1445  
   15.1 **Bluetoothデバイスアドレス** ......................................................... 1445  
      15.1.1 **Bluetoothデバイスアドレスの種類** ................................ 1445  
   15.2 **GATTプロファイル要件** ........................................................ 1445
   15.3 **SDP要件** ..................................................................... 1445  
   15.4 **SDPサービスレコード要件** ............................................... 1446  

16. **定義** ............................................................................................... 1448  
   16.1 **一般的な定義** .................................................................... 1448  
   16.2 **接続に関連する定義** ................................................... 1448  
   16.3 **デバイスに関連する定義** .......................................................... 1449  
   16.4 **手順に関連する定義** .................................................... 1450  
   16.5 **セキュリティに関連する定義** ........................................................ 1450  

17. **参考文献** .............................................................................................. 1452  

### 付録 A **タイマーおよび定数** ................................................................... 1453  

### 付録 B **関連手順の情報フロー** .................................. 1458  
   B.1 **LMP – 認証** ................................................................ 1458  
   B.2 **LMP – ペアリング** ............................................................................ 1459  
   B.3 **サービスディスカバリ** ...................................................................... 1459  
   B.4 **解決可能なプライベートアドレスの生成** .................................. 1460  
   B.5 **解決可能なプライベートアドレスの解決** .................................... 1460  

# Part D  
## テストサポート

1. **テスト方法論** ................................................................................... 1463  
   1.1 **BR/EDRテストシナリオ** .............................................................. 1463  
      1.1.1 **テストセットアップ** .................................................................. 1463  
      1.1.2 **送信テスト** .......................................................... 1464  
      1.1.3 **ループバックテスト** ............................................................ 1468  
      1.1.4 **一時停止テスト** .................................................................. 1472  
   1.2 【このセクションは使用されていません】 ................................................. 1472  
   1.3 **参考文献** ................................................................................ 1472  

2. 【このセクションは使用されていません】 ............................................................ 1473  

# Part E  
【このパートは使用されていません】

# Part F  
## 属性プロトコル (ATT)

1. **はじめに** ............................................................................................. 1478  
   1.1 **範囲** ........................................................................................ 1478  
   1.2 【このセクションは使用されていません】 ................................................. 1478
   1.3 **規約** .............................................................................. 1478  

2. **プロトコル概要** ................................................................................... 1479  

3. **プロトコル要件** ............................................................................ 1481  
   3.1 **はじめに** ............................................................................... 1481  
   3.2 **基本的な概念** .......................................................................... 1481  
      3.2.1 **属性タイプ** .............................................................. 1481  
      3.2.2 **属性ハンドル** ......................................................... 1481  
      3.2.3 **属性ハンドルのグループ化** .......................................... 1482  
      3.2.4 **属性値** ............................................................ 1482  
      3.2.5 **属性の権限** ................................................. 1482  
      3.2.6 **コントロールポイント属性** .............................................. 1484  
      3.2.7 **プロトコルメソッド** ....................................................... 1484  
      3.2.8 **MTUサイズの交換** ................................................ 1484  
      3.2.9 **長い属性値** ................................................. 1485  
      3.2.10 **アトミック操作** ...................................................... 1485  
      3.2.11 **ATTベアラー** ............................................................... 1486  
   3.3 **属性PDU** ............................................................................ 1486  
      3.3.1 **属性PDU形式** .................................................. 1488  
      3.3.2 **シーケンシャルプロトコル** .................................................... 1489  
      3.3.3 **トランザクション** ................................................................ 1490  
   3.4 **属性プロトコルPDU** ............................................................ 1490  
      3.4.1 **エラーハンドリング** ............................................................ 1490  
      3.4.2 **MTU交換** .......................................................... 1493  
      3.4.3 **情報の検索** ......................................................... 1495  
      3.4.4 **属性の読み取り** ..................................................... 1499  
      3.4.5 **属性の書き込み** ........................................................ 1511  
      3.4.6 **キューに入った書き込み** ............................................................ 1515  
      3.4.7 **サーバーによって開始された操作** ........................................................... 1519  
      3.4.8 **属性オペコードの概要** ........................................ 1521  
      3.4.9 **属性PDU応答の概要** ............................. 1523  

4. **セキュリティに関する考慮事項** ......................................................................... 1529  

5. **参考文献** .............................................................................................. 1531  

### 付録 A **PDU名の変更** ................................................................ 1532  

# Part G  
## 汎用属性プロファイル（GATT）

1. **はじめに** ............................................................................................. 1538  
   1.1 **範囲** ........................................................................................ 1538
   1.2 **プロファイル依存性** ................................................................... 1538  
   1.3 【このセクションは使用されていません】 ................................................. 1538  
   1.4 【このセクションは使用されていません】 ................................................. 1538  
   1.5 **規約** .............................................................................. 1538  

2. **プロファイル概要** ...................................................................................... 1539  
   2.1 **プロトコルスタック** ............................................................................ 1539  
   2.2 **構成と役割** ........................................................... 1539  
   2.3 **ユーザー要件とシナリオ** ............................................. 1540  
   2.4 **プロファイルの基本原則** ................................................................. 1541  
   2.5 **属性プロトコル** ....................................................................... 1541  
      2.5.1 **概要** .................................................................... 1541  
      2.5.2 **属性キャッシング** ........................................................ 1542  
      2.5.3 **属性のグループ化** ...................................................... 1548  
      2.5.4 **UUID** ........................................................................ 1548  
   2.6 **GATTプロファイル階層** .............................................................. 1548  
      2.6.1 **概要** .................................................................... 1548  
      2.6.2 **サービス** ....................................................................... 1549  
      2.6.3 **含まれるサービス** ....................................................... 1550  
      2.6.4 **特性** ............................................................. 1550  
   2.7 **構成されたブロードキャスト** ............................................................... 1550  

3. **サービスの相互運用性要件** .................................................. 1552  
   3.1 **サービス定義** ....................................................................... 1552  
   3.2 **含まれる定義** ....................................................................... 1553  
   3.3 **特性定義** ............................................................. 1553  
      3.3.1 **特性宣言** .......................................... 1554  
      3.3.2 **特性値の宣言** ................................ 1556  
      3.3.3 **特性ディスクリプタ宣言** ....................... 1556  
   3.4 **GATTプロファイル属性タイプの概要** .................................. 1563  

4. **GATT機能の要件** .................................................................... 1564  
   4.1 **概要** ................................................................................... 1564  
   4.2 **機能サポートと手順のマッピング** .................................. 1564  
   4.3 **サーバー構成** .................................................................. 1566  
      4.3.1 **MTUの交換** .......................................................... 1566  
   4.4 **プライマリサービスの発見** ........................................................ 1567  
      4.4.1 **すべてのプライマリサービスの発見** .................................... 1567  
      4.4.2 **サービスUUIDによるプライマリサービスの発見** ............... 1568  
   4.5 **関係の発見** .............................................................. 1570  
      4.5.1 **含まれるサービスの検索** .............................................. 1570  
   4.6 **特性の発見** ............................................................ 1571  
      4.6.1 **サービスのすべての特性の発見** ................... 1571
      4.6.2 **UUIDによる特性の発見** ............................. 1572  
   4.7 **特性ディスクリプタの発見** .......................................... 1574  
      4.7.1 **すべての特性ディスクリプタの発見** ...................... 1574  
   4.8 **特性値の読み取り** ......................................................... 1575  
      4.8.1 **特性値の読み取り** ......................................... 1575  
      4.8.2 **特性UUIDを使用した読み取り** ............................... 1576  
      4.8.3 **長い特性値の読み取り** ................................ 1577  
      4.8.4 **複数の特性値の読み取り** .......................... 1578  
      4.8.5 **可変長の複数特性値の読み取り** 1579  
   4.9 **特性値の書き込み** ......................................................... 1580  
      4.9.1 **応答なしでの書き込み** ............................................ 1580  
      4.9.2 **署名付き応答なしでの書き込み** ................................ 1580  
      4.9.3 **特性値の書き込み** ......................................... 1581  
      4.9.4 **長い特性値の書き込み** ................................ 1582  
      4.9.5 **特性値の信頼できる書き込み** .......................... 1583  
   4.10 **特性値の通知** ................................................ 1585  
      4.10.1 **単一通知** ...................................................... 1586  
      4.10.2 **可変長の複数通知** ........................ 1586  
   4.11 **特性値のインディケーション** .................................................. 1586  
      4.11.1 **インディケーション** ................................................................... 1587  
   4.12 **特性ディスクリプタ** ......................................................... 1587  
      4.12.1 **特性ディスクリプタの読み取り** .................................. 1587  
      4.12.2 **長い特性ディスクリプタの読み取り** ......................... 1588  
      4.12.3 **特性ディスクリプタの書き込み** .................................. 1589  
      4.12.4 **長い特性ディスクリプタの書き込み** ......................... 1590  
   4.13 **ATTプロトコルオペコードへのGATT手順のマッピング** ................. 1591  
   4.14 **手順のタイムアウト** ................................................................... 1594  

5. **L2CAPの相互運用性要件** ................................................... 1595  
   5.1 **BR/EDR L2CAPの相互運用性要件** .......................... 1595  
      5.1.1 **ATT_MTU** .................................................................. 1595  
      5.1.2 **BR/EDRチャネル要件** ................................. 1595  
      5.1.3 【このセクションは使用されていません】 ................................. 1596  
   5.2 **LE L2CAPの相互運用性要件** ................................... 1596  
      5.2.1 **ATT_MTU** .................................................................. 1596  
      5.2.2 **LEチャネル要件** ........................................... 1596  
   5.3 **拡張ATTベアラーL2CAPの相互運用性要件** .... 1596  
      5.3.1 **ATT_MTU** .................................................................. 1597  
      5.3.2 **チャネル要件** .............................................. 1597  
   5.4 **L2CAP衝突緩和** ......................................................... 1597  
   5.5 **ベアラーサポート** .......................................................................... 1597  

6. **GAPの相互運用性要件** ....................................................... 1599
   6.1 **BR/EDR GAPの相互運用性要件** .............................. 1599  
      6.1.1 **接続確立** ......................................... 1599  

   6.2 **LE GAPの相互運用性要件** ....................................... 1599  
      6.2.1 **接続確立** ......................................... 1599  
      6.2.2 **プロファイルの役割** ................................................................ 1600  

   6.3 **切断イベント** ................................................................. 1600  
      6.3.1 **切断中の通知およびインディケーション** ....... 1600  

7. **定義された汎用属性プロファイルサービス** ............................................. 1601  
   7.1 **サービス変更** ....................................................................... 1601  
   7.2 **クライアント対応機能** ........................................................ 1602  
   7.3 **データベースハッシュ** ......................................................................... 1604  
      7.3.1 **データベースハッシュの計算** ........................................ 1605  
   7.4 **サーバー対応機能** ....................................................... 1606  

8. **セキュリティに関する考慮事項** ......................................................................... 1607  
   8.1 **認証要件** ..................................................... 1607  
   8.2 **認可要件** ....................................................... 1608  

9. **SDPの相互運用性要件** ........................................................ 1609  

10. **参考文献** .............................................................................................. 1611  

### 付録 A **ATTサーバーのコンテンツ例** ...................................................... 1612  
### 付録 B **データベースハッシュの例** ............................................................... 1615  

# Part H  
## セキュリティマネージャー仕様

1. **はじめに** ............................................................................................. 1622  
   1.1 **範囲** ........................................................................................ 1622  
   1.2 **規約** .............................................................................. 1622  
      1.2.1 **ビットおよびバイトの順序規約** ............................. 1622  
      1.2.2 **ランダム数** ...................................................... 1623  

2. **セキュリティマネージャー** .................................................................................... 1624  
   2.1 **はじめに** ............................................................................... 1624  
   2.2 **暗号ツールボックス** ............................................................... 1626  
      2.2.1 **セキュリティ関数 e** ..................................................... 1627  
      2.2.2 **ランダムアドレスハッシュ関数 ah** ............................ 1627  
      2.2.3 **LEレガシーペアリングの確認値生成関数 c1** ............................. 1628  
      2.2.4 **LEレガシーペアリングのキー生成関数 s1** ...... 1629
      2.2.5 **AES-CMAC関数** ................................................. 1630  
      2.2.6 **LEセキュアコネクション確認値生成関数 f4** ................................................ 1630  
      2.2.7 **LEセキュアコネクションキー生成関数 f5** ... 1631  
      2.2.8 **LEセキュアコネクションチェック値生成関数 f6** ................................. 1633  
      2.2.9 **LEセキュアコネクション数値比較値生成関数 g2** ..................................... 1634  
      2.2.10 **リンクキー変換関数 h6** ................................ 1635  
      2.2.11 **リンクキー変換関数 h7** ................................ 1635  

   2.3 **ペアリング方法** ........................................................................ 1636  
      2.3.1 **セキュリティプロパティ** .................................................... 1637  
      2.3.2 **IO機能** ............................................................ 1638  
      2.3.3 **OOB認証データ** ........................................... 1638  
      2.3.4 **暗号化キーサイズ** .................................................... 1639  
      2.3.5 **ペアリングアルゴリズム** ...................................................... 1639  
      2.3.6 **繰り返しの試行** .................................................... 1654  

   2.4 **Bluetooth Low Energyのセキュリティ** ............................................. 1655  
      2.4.1 **キーと値の定義** ..................................... 1655  
      2.4.2 **配布キーの生成** ................................... 1656  
      2.4.3 **キーの配布** .................................................... 1658  
      2.4.4 **暗号化されたセッションのセットアップ** ........................................... 1659  
      2.4.5 **署名アルゴリズム** ....................................................... 1661  
      2.4.6 **ペリフェラルセキュリティリクエスト** ...................................... 1662  

3. **セキュリティマネージャープロトコル** .................................................................... 1665  
   3.1 **はじめに** ............................................................................... 1665  
   3.2 **L2CAP上のセキュリティマネージャーチャネル** ................................... 1665  
   3.3 **コマンド形式** ....................................................................... 1665  
   3.4 **SMPタイムアウト** .............................................................................. 1666  
   3.5 **ペアリング方法** ........................................................................ 1667  
      3.5.1 **ペアリングリクエスト** ......................................................... 1667  
      3.5.2 **ペアリングレスポンス** ...................................................... 1670  
      3.5.3 **ペアリング確認** .......................................................... 1672  
      3.5.4 **ペアリングランダム** ......................................................... 1673  
      3.5.5 **ペアリング失敗** ............................................................. 1674  
      3.5.6 **ペアリング公開鍵** ...................................................... 1676  
      3.5.7 **ペアリングDHKeyチェック** ................................................ 1676  
      3.5.8 **キー押下通知** ................................................. 1677  

   3.6 **Bluetooth Low Energyのセキュリティ** ............................................. 1678  
      3.6.1 **キーの配布と生成** ................................. 1678  
      3.6.2 **暗号化情報** ............................................... 1681  
      3.6.3 **セントラル識別** .................................................. 1682
      3.6.4 **アイデンティティ情報** .................................................... 1682  
      3.6.5 **アイデンティティアドレス情報** ...................................... 1683  
      3.6.6 **署名情報** .................................................... 1684  
      3.6.7 **セキュリティリクエスト** ....................................................... 1684  

4. **参考文献** .............................................................................................. 1686  

### 付録 A **EDIVおよびRandの生成** ........................................................... 1687  
   A.1 **EDIVマスキング** ............................................................................ 1687  
      A.1.1 **DIVマスク生成関数 dm** ............................. 1687  
      A.1.2 **EDIV生成** ........................................................ 1688  
      A.1.3 **DIVの復元** .............................................................. 1688  

### 付録 B **キー管理** ........................................................................... 1689  
   B.1 **データベース検索** ....................................................................... 1689  
   B.2 **キー階層** ............................................................................ 1689  
      B.2.1 **ダイバーシファイング関数 d1** ............................................. 1690  
      B.2.2 **ERからのキー生成** .......................................... 1691  
      B.2.3 **IRからのキー生成** ............................................ 1692  

### 付録 C **メッセージシーケンスチャート** ............................................................ 1693  
   C.1 **フェーズ1: ペアリング機能の交換** ........................................... 1694  
      C.1.1 **ペリフェラルセキュリティリクエスト - セントラルがペアリングを要求** 1694  
   C.2 **フェーズ2: 認証と暗号化** .................................... 1694  
      C.2.1 **LEレガシーペアリング** ....................................................... 1695  
      C.2.2 **LEセキュアコネクション** ............................................. 1697  
   C.3 **フェーズ3: トランスポート固有のキー配布** .............................. 1711  
   C.4 **以前に配布されたLTKを使用してセキュリティを再確立** .......... 1711  
      C.4.1 **セントラルによるセキュリティの開始 - セントラルによるリンクレイヤ暗号化** 1711  
      C.4.2 **ペリフェラルセキュリティリクエスト - セントラルによるリンクレイヤ暗号化の開始** 1712  
   C.5 **失敗条件** ...................................................................... 1712  
      C.5.1 **ペリフェラルによるペアリングの非サポート** .......................... 1712  
      C.5.2 **キーサイズの問題でセントラルがペアリングを拒否** ............... 1713  
      C.5.3 **キーサイズの問題でペリフェラルがペアリングを拒否** .......... 1713  
      C.5.4 **セントラルでのパスキー入力失敗** ............................... 1714  
      C.5.5 **ペリフェラルでのパスキー入力失敗** .......................... 1715  
      C.5.6 **ペリフェラルがセントラルの確認値を拒否** ................. 1715  
      C.5.7 **セントラルがペリフェラルの確認値を拒否** ................. 1716  

### 付録 D **サンプルデータ** ................................................................................... 1718  
   D.1 **AES-CMAC RFC4493テストベクタ** ............................................ 1718  
      D.1.1 **例1: 長さ = 0** .................................................... 1718
      D.1.2 **例2: 長さ = 16** .................................................. 1718  
      D.1.3 **例3: 長さ = 40** .................................................. 1718  
      D.1.4 **例4: 長さ = 64** .................................................. 1718  
   D.2 **f4 LE SC確認値生成関数** .............................. 1718  
   D.3 **f5 LE SCキー生成関数** .............................................. 1719  
   D.4 **f6 LE SCチェック値生成関数** ................................ 1719  
   D.5 **g2 LE SC数値比較生成関数** .................. 1720  
   D.6 **h6 LE SCリンクキー変換関数** ...................................... 1720  
   D.7 **ahランダムアドレスハッシュ関数** ........................................... 1720  
   D.8 **h7 LE SCリンクキー変換関数** ...................................... 1720  
   D.9 **LTKからリンクキーへの変換 (CT2=1を使用)** ................................... 1720  
   D.10 **LTKからリンクキーへの変換 (CT2=0を使用)** ................................... 1720  
   D.11 **リンクキーからLTKへの変換 (CT2=1を使用)** .................................. 1721  
   D.12 **リンクキーからLTKへの変換 (CT2=0を使用)** .................................. 1721

# Host Controller Interface  
## Specification Volume 4  

### Part A: UARTトランスポート層  
1. **一般** .................................................................................................... 1725  
2. **プロトコル** ................................................................................................... 1726  
3. **RS232設定** ........................................................................................ 1727  
4. **エラー回復** ......................................................................................... 1728  

### Part B: USBトランスポート層  
1. **概要** .................................................................................................. 1731  
2. **USBエンドポイントの期待事項** ................................................................... 1733  
   2.1 **ディスクリプタの概要** ................................................................... 1733  
      2.1.1 **コントローラーディスクリプタ** ................................................. 1733  
      2.1.2 【このセクションは使用されていません】 ................................. 1739  
   2.2 **コントロールエンドポイントの期待事項** ................................................... 1739  
      2.2.1 **単一機能コントローラー** .......................................... 1740  
      2.2.2 **複合デバイス内のコントローラー機能** .................. 1740  
      2.2.3 【このセクションは使用されていません】 ................................. 1740  
   2.3 **バルクエンドポイントの期待事項** ..................................................... 1740  
   2.4 **インタラプトエンドポイントの期待事項** ................................................. 1741  
   2.5 **アイソクロナスエンドポイントの期待事項** ......................................... 1741  

3. **クラスコード** ............................................................................................... 1742  
   3.1 **Bluetoothコード** ........................................................................ 1742  
      3.1.1 【このセクションは使用されていません】 ................................. 1742  
      3.1.2 【このセクションは使用されていません】 ................................. 1742  
      3.1.3 【このセクションは使用されていません】 ................................. 1742  
      3.1.4 【このセクションは使用されていません】 ................................. 1742  

4. **デバイスファームウェアのアップグレード** ....................................................................... 1743  
5. **制限事項** ............................................................................................... 1744  
   5.1 **電力に関する制限事項** .......................................................... 1744  
   5.2 **その他の制限事項** ........................................................................ 1744
6. **Bluetooth複合デバイスの実装** ..................................... 1745  
   6.1 **構成** ........................................................................... 1745  
   6.2 **コントローラ機能用USBインターフェースアソシエーションディスクリプタの使用** ............................................................. 1745  
   6.3 【このセクションは使用されていません】 ................................................. 1746  

7. **参考文献** .............................................................................................. 1747  

### Part C: SECURE DIGITAL (SD) トランスポート層  
1. **はじめに** ............................................................................................. 1750  
2. **目標** ........................................................................................................ 1751  
   2.1 **ハードウェアの目標** ......................................................................... 1751  
   2.2 **ソフトウェアの目標** .......................................................................... 1751  
   2.3 **構成の目標** ................................................................... 1751  
   2.4 **複数コントローラの構成** ........................................ 1752  

3. **物理インターフェース文書** ............................................................... 1753  
4. **通信** ....................................................................................... 1754  
   4.1 **概要** ................................................................................... 1754  

### 付録 A: 頭字語と略語 ...................................................... 1755  
### 付録 B: 関連文書 ....................................................................... 1756  
### 付録 C: テスト ............................................................................................... 1757  
   C.1 **テストスイートの構造** .................................................................... 1757  

### Part D: THREE-WIRE UART トランスポート層  
1. **一般** .................................................................................................... 1761  
2. **概要** .................................................................................................. 1762  
3. **スリップ層** .................................................................................................. 1763  
   3.1 **パケットのエンコード** ..................................................................... 1763  
   3.2 **パケットのデコード** .................................................................... 1763  

4. **パケットヘッダー** ......................................................................................... 1765  
   4.1 **シーケンス番号** .................................................................... 1765  
   4.2 **確認番号** ............................................................... 1765
   4.3 **データ整合性チェックの有無** .................................................... 1766  
   4.4 **信頼性のあるパケット** ......................................................................... 1766  
   4.5 **パケットタイプ** .............................................................................. 1766  
   4.6 **ペイロード長** ......................................................................... 1767  
   4.7 **パケットヘッダーチェックサム** ........................................................ 1767  

5. **データ整合性チェック** ............................................................................... 1768  
   5.1 **16ビットCCITT-CRC** ..................................................................... 1768  

6. **信頼性のあるパケット** ...................................................................................... 1769  
   6.1 **ヘッダーチェックサムエラー** ............................................................ 1769  
   6.2 **スリップペイロード長エラー** .......................................................... 1769  
   6.3 **データ整合性チェックエラー** ......................................................... 1769  
   6.4 **シーケンス外パケットエラー** .................................................. 1769  
   6.5 **確認応答** ....................................................................... 1770  
   6.6 **パケットの再送** .................................................................... 1770  
   6.7 **信頼性のあるパケットフローの例** ..................................................... 1770  

7. **信頼性のないパケット** .................................................................................. 1773  
   7.1 **信頼性のないパケットヘッダー** .......................................................... 1773  
   7.2 **信頼性のないパケットエラー** .............................................................. 1773  

8. **リンク確立** ................................................................................. 1774  
   8.1 **未初期化状態** ...................................................................... 1774  
   8.2 **初期化済み状態** .......................................................................... 1775  
   8.3 **アクティブ状態** ................................................................................ 1775  
   8.4 **同期メッセージ** ........................................................................... 1775  
   8.5 **同期応答メッセージ** ......................................................... 1776  
   8.6 **設定メッセージ** ........................................................................ 1776  
   8.7 **設定応答メッセージ** ....................................................... 1777  
   8.8 **構成フィールド** .................................................................... 1777  
      8.8.1 **構成メッセージ** ............................................ 1778  
      8.8.2 **スライディングウィンドウサイズ** .................................................... 1778  
      8.8.3 **データ整合性チェックのレベル** .................................... 1778  
      8.8.4 **フレーム外ソフトウェアフロー制御** ................................. 1779  
      8.8.5 **バージョン番号** ......................................................... 1779  

9. **低消費電力** ............................................................................................... 1780  
   9.1 **ウェイクアップメッセージ** ...................................................................... 1780  
   9.2 **起動メッセージ** ........................................................................ 1780  
   9.3 **スリープメッセージ** ......................................................................... 1781  

10. **フレーム外制御** .............................................................................. 1782  
   10.1 **ソフトウェアフロー制御** ............................................................... 1782  

11. **ハードウェア構成** .......................................................................... 1783  
   11.1 **配線** ......................................................................................... 1783  
      11.1.1 **送信と受信** ..................................................... 1783  
      11.1.2 **グランド** ....................................................................... 1783  
   11.2 **ハードウェアフロー** ........................................................................... 1783  
      11.2.1 **RTSとCTS** ................................................................ 1783  

12. **推奨パラメータ** .................................................................... 1784  
   12.1 **タイミングパラメータ** .................................................................... 1784  
      12.1.1 **パケットの確認応答** ...................................... 1784  
      12.1.2 **信頼性のあるパケットの再送** ....................................... 1784  

13. **参考文献** .............................................................................................. 1785  

### Part E: HOST CONTROLLER INTERFACE 機能仕様  
1. **はじめに** ............................................................................................. 1802  
   1.1 **Bluetoothソフトウェアスタックの下位レイヤー** .......................... 1803  
   1.2 **バージョン間の問題** ................................................................. 1804  

2. **ホストコントローラートランスポート層の概要** ........................................ 1806  
   2.1 【このセクションは使用されていません】 ................................................. 1806  

3. **コマンドとイベントの概要** ...................................................... 1807  
   3.1 **LEコントローラーの要件** ....................................................... 1857  
      3.1.1 **レガシーおよび拡張広告** .............................. 1857  
   3.2 **基盤サポート** ................................................................... 1858  
   3.3 **機能交換** ..................................................................... 1859  

4. **HCIフロー制御** ...................................................................................... 1860  
   4.1 **ホストからコントローラーへのデータフロー制御** ........................................... 1860  
      4.1.1 **パケットベースのデータフロー制御** ................................. 1861  
      4.1.2 **データブロックベースのデータフロー制御** ........................... 1862  
   4.2 **コントローラーからホストへのデータフロー制御** ........................................... 1863  
   4.3 **切断時の挙動** ............................................................. 1864  
   4.4 **コマンドフロー制御** .............................................................. 1864  
   4.5 **コマンドエラー処理** .......................................................... 1866  
   4.6 **LMPトランザクションおよびLL手続きの衝突** ........................... 1867  
   4.7 **LEホストとコントローラーの同期** .................................... 1867  
   4.8 **バージョン化されたイベント** ....................................................................... 1868  

5. **HCIデータ形式** ..................................................................................... 1869  
   5.1 **正確性** ............................................................................... 1869
   5.2 **データおよびパラメータ形式** ..................................................... 1869  
   5.3 **IDとハンドル** ........................................................................ 1870  
      5.3.1 **コントローラーハンドル** ..................................................... 1870  
      5.3.2 【このセクションは使用されていません】 ................................. 1872  
   5.4 **HCI固有情報の交換** ....................................... 1872  
      5.4.1 **HCIコマンドパケット** ............................................... 1872  
      5.4.2 **HCI ACLデータパケット** ............................................... 1874  
      5.4.3 **HCI同期データパケット** ................................ 1876  
      5.4.4 **HCIイベントパケット** ....................................................... 1877  
      5.4.5 **HCI ISOデータパケット** ............................................... 1878  
   5.5 **無視されるパラメータ** ................................................................... 1881  

6. **HCI構成パラメータ** ............................................................... 1882  
   6.1 **スキャンの有効化** .............................................................................. 1882  
   6.2 **問い合わせスキャン間隔** ................................................................. 1882  
   6.3 **問い合わせスキャンウィンドウ** ................................................................ 1883  
   6.4 **問い合わせスキャンタイプ** ..................................................................... 1883  
   6.5 **問い合わせモード** ............................................................................. 1883  
   6.6 **ページタイムアウト** ............................................................................ 1884  
   6.7 **接続承諾タイムアウト** ...................................................... 1884  
   6.8 **ページスキャン間隔** .................................................................... 1885  
   6.9 **ページスキャンウィンドウ** ................................................................... 1885  
   6.10 【このセクションは使用されていません】 ................................................. 1885  
   6.11 **ページスキャンタイプ** ........................................................................ 1885  
   6.12 **ボイス設定** ............................................................................. 1886  
   6.13 **PINタイプ** .................................................................................... 1887  
   6.14 **リンクキー** ..................................................................................... 1887  
   6.15 **失敗した接続カウンター** ............................................................. 1887  
   6.16 **認証有効化** ............................................................... 1888  
   6.17 **ホールドモード活動** ..................................................................... 1888  
   6.18 **リンクポリシー設定** ................................................................... 1889  
   6.19 **フラッシュタイムアウト** ............................................................................ 1889  
   6.20 **ブロードキャスト再送回数** .............................................. 1890  
   6.21 **リンク監督タイムアウト** .......................................................... 1890  
   6.22 **同期フロー制御有効化** ............................................ 1891  
   6.23 **ローカル名** ............................................................................... 1891  
   6.24 **拡張問い合わせ応答** ....................................................... 1892  
   6.25 **誤ったデータレポート** ........................................................ 1892  
   6.26 **デバイスクラス** ......................................................................... 1892  
   6.27 **サポートされているコマンド** ............................................................... 1892  
   6.28 【このセクションは使用されていません】 ................................................. 1905  
   6.29 【このセクションは使用されていません】 ................................................. 1905  
   6.30 【このセクションは使用されていません】 ................................................. 1905  
   6.31 【このセクションは使用されていません】 ................................................. 1905  
   6.32 【このセクションは使用されていません】 ................................................. 1905  
   6.33 **フロー制御モード** .................................................................... 1905  
   6.34 **LEサポートホスト** .................................................................... 1905  
   6.35 【このセクションは使用されていません】 ................................................. 1905  
   6.36 **同期トレイン間隔** .................................................................... 1905  
   6.37 **同期トレインタイムアウト** ................................................................... 1906  
   6.38 **サービスデータ** .............................................................................. 1906  
   6.39 **セキュア接続ホストサポート** ............................................ 1906  
   6.40 **認証済みペイロードタイムアウト** ................................................ 1907  
   6.41 **拡張ページタイムアウト** ............................................................ 1907  
   6.42 **拡張問い合わせ長** ........................................................... 1908  

7. **HCIコマンドとイベント** .................................................................... 1909  
   7.1 **リンク制御コマンド** ............................................................ 1909  
      7.1.1 **問い合わせコマンド** ....................................................... 1909  
      7.1.2 **問い合わせキャンセルコマンド** ........................................... 1912  
      7.1.3 **定期問い合わせモードコマンド** ............................... 1913  
      7.1.4 **定期問い合わせモード終了コマンド** ........................ 1916  
      7.1.5 **接続作成コマンド** .................................... 1917  
      7.1.6 **切断コマンド** ................................................ 1920  
      7.1.7 **接続作成キャンセルコマンド** ........................ 1922  
      7.1.8 **接続要求承諾コマンド** ..................... 1924  
      7.1.9 **接続要求拒否コマンド** .............................. 1926  
      7.1.10 **リンクキー要求返信コマンド** ........................... 1927  
      7.1.11 **リンクキー要求否定返信コマンド** ............ 1929  
      7.1.12 **PINコード要求返信コマンド** .......................... 1931  
      7.1.13 **PINコード要求否定返信コマンド** .......... 1933  
      7.1.14 **接続パケットタイプ変更コマンド** ............. 1935  
      7.1.15 **認証要求コマンド** ................................. 1937  
      7.1.16 **接続暗号化設定コマンド** ....................... 1939  
      7.1.17 **接続リンクキー変更コマンド** ................... 1941  
      7.1.18 **リンクキー選択コマンド** .................................... 1942  
      7.1.19 **リモートネーム要求コマンド** ............................ 1944  
      7.1.20 **リモートネーム要求キャンセルコマンド** ................ 1946  
      7.1.21 **リモートサポート機能読み取りコマンド** ........... 1948  
      7.1.22 **リモート拡張機能読み取りコマンド** ............ 1949  
      7.1.23 **リモートバージョン情報読み取りコマンド** ............ 1951  
      7.1.24 **クロックオフセット読み取りコマンド** ............................. 1952  
      7.1.25 **LMPハンドル読み取りコマンド** .................................... 1953  
      7.1.26 **同期接続セットアップコマンド** ............... 1955  
      7.1.27 **同期接続要求承諾コマンド** 1959  
      7.1.28 **同期接続要求拒否コマンド** 1962  
      7.1.29 **IO機能要求返信コマンド** ..................... 1963  
      7.1.30 **ユーザー確認要求返信コマンド** ............ 1966  
      7.1.31 **ユーザー確認要求否定返信コマンド** ............ 1967  
      7.1.32 **ユーザーパスキー要求返信コマンド** ................... 1968  
      7.1.33 **ユーザーパスキー要求否定返信コマンド** .... 1969  
      7.1.34 **リモートOOBデータ要求返信コマンド** ........... 1970  
      7.1.35 **リモートOOBデータ要求否定返信コマンド** ............ 1972  
      7.1.36 **IO機能要求否定返信コマンド** ..... 1973  
      7.1.37 【このセクションは使用されていません】 ................................. 1975  
      7.1.38 【このセクションは使用されていません】 ................................. 1975  
      7.1.39 【このセクションは使用されていません】 ................................. 1975  
      7.1.40 【このセクションは使用されていません】 ................................. 1975  
      7.1.41 【このセクションは使用されていません】 ................................. 1975  
      7.1.42 【このセクションは使用されていません】 ................................. 1975  
      7.1.43 【このセクションは使用されていません】 ................................. 1975  
      7.1.44 【このセクションは使用されていません】 ................................. 1975  
      7.1.45 **強化同期接続セットアップコマンド** ............... 1976  
      7.1.46 **強化同期接続要求承諾コマンド** ........................ 1986  
      7.1.47 **短縮ページコマンド** ........................................ 1993  
      7.1.48 **短縮ページキャンセルコマンド** ............................ 1995  
      7.1.49 **接続レス周辺ブロードキャスト設定コマンド** 1997  
      7.1.50 **接続レス周辺ブロードキャスト受信コマンド** ........................ 2001  
      7.1.51 **同期トレイン開始コマンド** ............................... 2005  
      7.1.52 **同期トレイン受信コマンド** ................. 2006  
      7.1.53 **リモートOOB拡張データ要求返信コマンド** ............... 2008  

   7.2 **リンクポリシーコマンド** .............................................................. 2010  
      7.2.1 **ホールドモードコマンド** ................................................. 2010  
      7.2.2 **スニッフモードコマンド** ................................................. 2013  
      7.2.3 **スニッフモード終了コマンド** .......................................... 2016  
      7.2.4 【このセクションは使用されていません】 ................................. 2017  
      7.2.5 【このセクションは使用されていません】 ................................. 2017  
      7.2.6 **QoS設定コマンド** ................................................ 2018  
      7.2.7 **ロールディスカバリーコマンド** .......................................... 2021  
      7.2.8 **ロールスイッチコマンド** ............................................... 2023  
      7.2.9 **リンクポリシー設定読み取りコマンド** ......................... 2025  
      7.2.10 **リンクポリシー設定書き込みコマンド** ......................... 2027  
      7.2.11 **デフォルトリンクポリシー設定読み取りコマンド** ............. 2029  
      7.2.12 **デフォルトリンクポリシー設定書き込みコマンド** ............. 2030  
      7.2.13 **フロースペシフィケーションコマンド** ..................................... 2031  
      7.2.14 **スニッフサブレーティングコマンド** .......................................... 2034  

   7.3 **コントローラ＆ベースバンドコマンド** ........................................... 2037  
      7.3.1 **イベントマスク設定コマンド** ......................................... 2037  
      7.3.2 **リセットコマンド** ......................................................... 2040  
      7.3.3 **イベントフィルタ設定コマンド** ......................................... 2041  
      7.3.4 **フラッシュコマンド** ......................................................... 2048  
      7.3.5 **PINタイプ読み取りコマンド** ......................................... 2050  
      7.3.6 **PINタイプ書き込みコマンド** .......................................... 2051  
      7.3.7 【このセクションは使用されていません】 ................................. 2052  
      7.3.8 **保存されたリンクキー読み取りコマンド** ............................... 2053  
      7.3.9 **保存されたリンクキー書き込みコマンド** ............................... 2055  
      7.3.10 **保存されたリンクキー削除コマンド** ............................. 2057  
      7.3.11 **ローカル名書き込みコマンド** ..................................... 2059  
      7.3.12 **ローカル名読み取りコマンド** ..................................... 2060  
      7.3.13 **接続承諾タイムアウト読み取りコマンド** ............ 2061  
      7.3.14 **接続承諾タイムアウト書き込みコマンド** ............ 2062  
      7.3.15 **ページタイムアウト読み取りコマンド** .................................. 2063  
      7.3.16 **ページタイムアウト書き込みコマンド** .................................. 2064  
      7.3.17 **スキャン有効読み取りコマンド** .................................... 2065  
      7.3.18 **スキャン有効書き込みコマンド** .................................... 2066  
      7.3.19 **ページスキャンアクティビティ読み取りコマンド** .......................... 2067  
      7.3.20 **ページスキャンアクティビティ書き込みコマンド** ........................... 2069  
      7.3.21 **問い合わせスキャンアクティビティ読み取りコマンド** ........................ 2070  
      7.3.22 **問い合わせスキャンアクティビティ書き込みコマンド** ........................ 2072  
      7.3.23 **認証有効読み取りコマンド** ..................... 2073  
      7.3.24 **認証有効書き込みコマンド** ...................... 2074  
      7.3.25 **デバイスクラス読み取りコマンド** ............................... 2075  
      7.3.26 **デバイスクラス書き込みコマンド** ................................ 2076  
      7.3.27 **ボイス設定読み取りコマンド** ................................... 2077  
      7.3.28 **ボイス設定書き込みコマンド** .................................... 2078  
      7.3.29 **自動フラッシュタイムアウト読み取りコマンド** ................. 2079  
      7.3.30 **自動フラッシュタイムアウト書き込みコマンド** ................. 2081  
      7.3.31 **ブロードキャスト再送回数読み取りコマンド** .... 2083  
      7.3.32 **ブロードキャスト再送回数書き込みコマンド** .... 2084  
      7.3.33 **ホールドモードアクティビティ読み取りコマンド** .......................... 2085  
      7.3.34 **ホールドモードアクティビティ書き込みコマンド** ........................... 2086  
      7.3.35 **送信電力レベル読み取りコマンド** ...................... 2087  
      7.3.36 **同期フロー制御有効読み取りコマンド** .................. 2089  
      7.3.37 **同期フロー制御有効書き込みコマンド** .................. 2090  
      7.3.38 **コントローラからホストへのフロー制御設定コマンド** ......... 2091  
      7.3.39 **ホストバッファサイズコマンド** ........................................ 2093  
      7.3.40 **ホスト完了パケット数コマンド** ........ 2096  
      7.3.41 **リンク監視タイムアウト読み取りコマンド** ................ 2098  
      7.3.42 **リンク監視タイムアウト書き込みコマンド** ................ 2100  
      7.3.43 **サポートされているIAC数読み取りコマンド** .............. 2102  
      7.3.44 **現在のIAC LAP読み取りコマンド** ............................. 2103  
      7.3.45 **現在のIAC LAP書き込みコマンド** .............................. 2105  
      7.3.46 **AFHホストチャネル分類設定コマンド** ....... 2107  
      7.3.47 **問い合わせスキャンタイプ読み取りコマンド** ........................... 2109  
      7.3.48 **問い合わせスキャンタイプ書き込みコマンド** ............................ 2110  
      7.3.49 **問い合わせモード読み取りコマンド** ................................... 2111  
      7.3.50 **問い合わせモード書き込みコマンド** .................................... 2112  
      7.3.51 **ページスキャンタイプ読み取りコマンド** .............................. 2113  
      7.3.52 **ページスキャンタイプ書き込みコマンド** .............................. 2114  
      7.3.53 **AFHチャネル評価モード読み取りコマンド** .... 2115  
      7.3.54 **AFHチャネル評価モード書き込みコマンド** .... 2116  
      7.3.55 **拡張問い合わせ応答読み取りコマンド** ............ 2118  
      7.3.56 **拡張問い合わせ応答書き込みコマンド** ............ 2119  
      7.3.57 **暗号化キーのリフレッシュコマンド** ............................ 2121  
      7.3.58 **シンプルペアリングモード読み取りコマンド** ....................... 2122  
      7.3.59 **シンプルペアリングモード書き込みコマンド** ....................... 2123  
      7.3.60 **ローカルOOBデータ読み取りコマンド** .............................. 2125  
      7.3.61 **問い合わせ応答送信電力レベル読み取りコマンド** ........................ 2127  
      7.3.62 **問い合わせ送信電力レベル書き込みコマンド** .......... 2128  
      7.3.63 **キープレス通知送信コマンド** ....................... 2129  
      7.3.64 **デフォルトのエラーデータ報告読み取りコマンド** .. 2131  
      7.3.65 **デフォルトのエラーデータ報告書き込みコマンド** .. 2132  
      7.3.66 **強化フラッシュコマンド** ........................................ 2133  
      7.3.67 【このセクションは使用されていません】 ................................. 2135  
      7.3.68 【このセクションは使用されていません】 ................................. 2135  
      7.3.69 **イベントマスクページ2設定コマンド** ............................ 2136  
      7.3.70 【このセクションは使用されていません】 ................................. 2138  
      7.3.71 【このセクションは使用されていません】 ................................. 2138  
      7.3.72 **フロー制御モード読み取りコマンド** .......................... 2139  
      7.3.73 **フロー制御モード書き込みコマンド** .......................... 2140  
      7.3.74 **強化送信電力レベル読み取りコマンド** .... 2141  
      7.3.75 【このセクションは使用されていません】 ................................. 2143  
      7.3.76 【このセクションは使用されていません】 ................................. 2143  
      7.3.77 【このセクションは使用されていません】 ................................. 2143  
      7.3.78 **LEホストサポート読み取りコマンド** .............................. 2144  
      7.3.79 **LEホストサポート書き込みコマンド** .............................. 2145  
      7.3.80 **MWSチャネルパラメータ設定コマンド** ................. 2146  
      7.3.81 **外部フレーム構成設定コマンド** ............ 2148  
      7.3.82 **MWSシグナリング設定コマンド** ................................... 2151  
      7.3.83 **MWSトランスポート層設定コマンド** ........................ 2156  
      7.3.84 **MWSスキャン周波数テーブル設定コマンド** .............. 2157  
      7.3.85 **MWS_PATTERN設定コマンド** .......... 2159  
      7.3.86 **予約LT_ADDR設定コマンド** ........................... 2162  
      7.3.87 **予約LT_ADDR削除コマンド** ...................... 2164  
      7.3.88 **接続レスペリフェラルブロードキャストデータ設定コマンド** .... 2166  
      7.3.89 **同期トレインパラメータ読み取りコマンド** ...... 2168  
      7.3.90 **同期トレインパラメータ書き込みコマンド** ...... 2170  
      7.3.91 **セキュア接続ホストサポート読み取りコマンド** ...... 2172  
      7.3.92 **セキュア接続ホストサポート書き込みコマンド** ...... 2173  
      7.3.93 **認証済みペイロードタイムアウト読み取りコマンド** ...... 2175  
      7.3.94 **認証済みペイロードタイムアウト書き込みコマンド** ....... 2177  
      7.3.95 **ローカルOOB拡張データ読み取りコマンド** .............. 2179  
      7.3.96 **拡張ページタイムアウト読み取りコマンド** .................. 2181  
      7.3.97 **拡張ページタイムアウト書き込みコマンド** .................. 2182  
      7.3.98 **拡張問い合わせ長さ読み取りコマンド** ................. 2183  
      7.3.99 **拡張問い合わせ長さ書き込みコマンド** .................. 2184  
      7.3.100 **エコシステム基本間隔設定コマンド** .................... 2185  
      7.3.101 **データパス設定コマンド** ................................. 2187  
      7.3.102 **最小暗号化キーサイズ設定コマンド** .................... 2189  
   7.4 **情報パラメータ** .......................................................... 2190  
      7.4.1 **ローカルバージョン情報読み取りコマンド** ................ 2190  
      7.4.2 **ローカルサポートコマンド読み取りコマンド** ........... 2192  
      7.4.3 **ローカルサポート機能読み取りコマンド** ............... 2193  
      7.4.4 **ローカル拡張機能読み取りコマンド** ................ 2194  
      7.4.5 **バッファサイズ読み取りコマンド** ....................................... 2196  
      7.4.6 **BD_ADDR読み取りコマンド** ....................................... 2199  
      7.4.7 **データブロックサイズ読み取りコマンド** ............................... 2200  
      7.4.8 **ローカルサポートコーデック読み取りコマンド** ................. 2202  
      7.4.9 **ローカルシンプルペアリングオプション読み取りコマンド** .......... 2205  
      7.4.10 **ローカルサポートコーデック機能読み取りコマンド** 2207  
      7.4.11 **ローカルサポートコントローラ遅延読み取りコマンド** ... 2209  
   7.5 **ステータスパラメータ** ..................................................................... 2212  
      7.5.1 **失敗した接触カウンタ読み取りコマンド** ................... 2212  
      7.5.2 **失敗した接触カウンタリセットコマンド** .................. 2214  
      7.5.3 **リンク品質読み取りコマンド** ..................................... 2215  
      7.5.4 **RSSI読み取りコマンド** ................................................ 2217  
      7.5.5 **AFHチャネルマップ読み取りコマンド** ........................... 2219  
      7.5.6 **クロック読み取りコマンド** ............................................... 2221  
      7.5.7 **暗号化キーサイズ読み取りコマンド** ........................ 2223  
      7.5.8 【このセクションは使用されていません】 ................................. 2225  
      7.5.9 【このセクションは使用されていません】 ................................. 2225  
      7.5.10 **[このセクションは使用されていません]** ................................. 2225  
      7.5.11 **MWSトランスポート層設定読み取りコマンド** .. 2226  
      7.5.12 **トリガークロックキャプチャ設定コマンド** .................... 2229  
   7.6 **テストコマンド** .................................................................... 2232  
      7.6.1 **ループバックモード読み取りコマンド** ............................... 2232  
      7.6.2 **ループバックモード書き込みコマンド** ............................... 2234  
      7.6.3 **実装テストモード有効化コマンド** . 2237  
      7.6.4 **シンプルペアリングデバッグモード書き込みコマンド** ............ 2238  
      7.6.5 **[このセクションは使用されていません]** ................................. 2240  
      7.6.6 **[このセクションは使用されていません]** ................................. 2240  
      7.6.7 **[このセクションは使用されていません]** ................................. 2240  
      7.6.8 **セキュア接続テストモード書き込みコマンド** ....... 2241  
   7.7 **イベント** ....................................................................................... 2245  
      7.7.1 **問い合わせ完了イベント** .............................................. 2245  
      7.7.2 **問い合わせ結果イベント** ................................................... 2246  
      7.7.3 **接続完了イベント** ...................................... 2248  
      7.7.4 **接続要求イベント** ........................................ 2250  
      7.7.5 **切断完了イベント** .................................. 2252  
      7.7.6 **認証完了イベント** .................................. 2254  
      7.7.7 **リモートネームリクエスト完了イベント** ................... 2255  
      7.7.8 **暗号化変更イベント** .......................................... 2256  
      7.7.9 **接続リンクキー変更完了イベント** .......... 2258  
      7.7.10 **リンクキータイプ変更イベント** ................................... 2259  
      7.7.11 **リモートサポート機能読み取り完了イベント** . 2261  
      7.7.12 **リモートバージョン情報読み取り完了イベント** .. 2262  
      7.7.13 **QoSセットアップ完了イベント** ....................................... 2264  
      7.7.14 **コマンド完了イベント** ........................................ 2266  
      7.7.15 **コマンドステータスイベント** ............................................. 2268  
      7.7.16 **ハードウェアエラーイベント** ................................................ 2270  
      7.7.17 **フラッシュ発生イベント** ................................................ 2271  
      7.7.18 **ロール変更イベント** .................................................... 2272  
      7.7.19 **完了パケット数イベント** ....................... 2273  
      7.7.20 **モード変更イベント** .................................................. 2275  
      7.7.21 **リンクキー返却イベント** ............................................. 2277  
      7.7.22 **PINコードリクエストイベント** ........................................... 2278  
      7.7.23 **リンクキーリクエストイベント** ............................................. 2279  
      7.7.24 **リンクキーノーティフィケーションイベント** ........................................ 2280  
      7.7.25 **ループバックコマンドイベント** ........................................ 2282  
      7.7.26 **データバッファオーバーフローイベント** ........................................ 2283  
      7.7.27 **最大スロット変更イベント** ........................................... 2284  
      7.7.28 **クロックオフセット読み取り完了イベント** ........................... 2285  
      7.7.29 **接続パケットタイプ変更イベント** .................. 2286  
      7.7.30 **QoS違反イベント** ................................................... 2288
      7.7.31 **ページスキャンリピティションモード変更イベント** .............. 2289  
      7.7.32 **フロー仕様完了イベント** ........................... 2290  
      7.7.33 **RSSI付き問い合わせ結果イベント** .................................. 2293  
      7.7.34 **リモート拡張機能読み取り完了イベント** ... 2295  
      7.7.35 **同期接続完了イベント** ................ 2297  
      7.7.36 **同期接続変更イベント** ................. 2300  
      7.7.37 **スニッフサブレーティングイベント** ......................................... 2302  
      7.7.38 **拡張問い合わせ結果イベント** ................................... 2304  
      7.7.39 **暗号化キー更新完了イベント** ................... 2307  
      7.7.40 **IOキャパビリティ要求イベント** ...................................... 2308  
      7.7.41 **IOキャパビリティ応答イベント** ................................... 2309  
      7.7.42 **ユーザー確認要求イベント** ............................. 2311  
      7.7.43 **ユーザーパスキー要求イベント** .................................... 2312  
      7.7.44 **リモートOOBデータ要求イベント** ............................ 2313  
      7.7.45 **シンプルペアリング完了イベント** ................................. 2314  
      7.7.46 **リンク監視タイムアウト変更イベント** ................. 2315  
      7.7.47 **拡張フラッシュ完了イベント** .............................. 2316  
      7.7.48 **ユーザーパスキーノーティフィケーションイベント** ................................ 2317  
      7.7.49 **キープレスノーティフィケーションイベント** ....................................... 2318  
      7.7.50 **リモートホストサポート機能通知イベント** 2319  
      7.7.51 **[このセクションは使用されていません]** ................................. 2320  
      7.7.52 **[このセクションは使用されていません]** ................................. 2320  
      7.7.53 **[このセクションは使用されていません]** ................................. 2320  
      7.7.54 **[このセクションは使用されていません]** ................................. 2320  
      7.7.55 **[このセクションは使用されていません]** ................................. 2320  
      7.7.56 **[このセクションは使用されていません]** ................................. 2320  
      7.7.57 **[このセクションは使用されていません]** ................................. 2320  
      7.7.58 **[このセクションは使用されていません]** ................................. 2320  
      7.7.59 **完了データブロック数イベント** ................. 2321  
      7.7.60 **[このセクションは使用されていません]** ................................. 2323  
      7.7.61 **[このセクションは使用されていません]** ................................. 2323  
      7.7.62 **[このセクションは使用されていません]** ................................. 2323  
      7.7.63 **[このセクションは使用されていません]** ................................. 2323  
      7.7.64 **[このセクションは使用されていません]** ................................. 2323  
      7.7.65 **LEメタイベント** ............................................................ 2324  
      7.7.66 **トリガークロックキャプチャイベント** .................................. 2468  
      7.7.67 **同期トレイン完了イベント** ...................... 2470  
      7.7.68 **同期トレイン受信イベント** ...................... 2471  
      7.7.69 **接続レスペリフェラルブロードキャスト受信イベント** 2473  
      7.7.70 **接続レスペリフェラルブロードキャストタイムアウトイベント** 2475  
      7.7.71 **切り詰められたページ完了イベント** ............................... 2476  
      7.7.72 **ペリフェラルページ応答タイムアウトイベント** ................ 2477
      7.7.73 **接続レスペリフェラルブロードキャストチャネルマップ変更イベント** ........................................ 2478  
      7.7.74 **問い合わせ応答通知イベント** ........................................ 2479  
      7.7.75 **認証済みペイロードタイムアウト期限切れイベント** .......................... 2480  
      7.7.76 **SAMステータス変更イベント** ........................................ 2481  
   7.8 **LEコントローラーコマンド** ........................................................... 2483  
      7.8.1 **LEイベントマスク設定コマンド** ................................... 2483  
      7.8.2 **LEバッファサイズ読み取りコマンド** ................................. 2486  
      7.8.3 **LEローカルサポート機能ページ0読み取りコマンド** .......................... 2489  
      7.8.4 **LEランダムアドレス設定コマンド** .......................... 2490  
      7.8.5 **LE広告パラメータ設定コマンド** ................. 2492  
      7.8.6 **LE広告物理チャネル送信電力読み取りコマンド** .......................... 2496  
      7.8.7 **LE広告データ設定コマンド** ............................ 2497  
      7.8.8 **LEスキャン応答データ設定コマンド** .................... 2499  
      7.8.9 **LE広告有効化コマンド** ........................ 2501  
      7.8.10 **LEスキャンパラメータ設定コマンド** .......................... 2503  
      7.8.11 **LEスキャン有効化コマンド** .................................. 2506  
      7.8.12 **LE接続作成コマンド** .............................. 2508  
      7.8.13 **LE接続作成キャンセルコマンド** .................. 2514  
      7.8.14 **LEフィルター受入リストサイズ読み取りコマンド** ................ 2515  
      7.8.15 **LEフィルター受入リストクリアコマンド** ........................ 2516  
      7.8.16 **LEデバイス追加フィルター受入リストコマンド** .......... 2517  
      7.8.17 **LEデバイス削除フィルター受入リストコマンド** ........................ 2519  
      7.8.18 **LE接続更新コマンド** .............................. 2521  
      7.8.19 **LEホストチャネル分類設定コマンド** .......... 2524  
      7.8.20 **LEチャネルマップ読み取りコマンド** ............................. 2526  
      7.8.21 **LEリモート機能ページ0読み取りコマンド** ........... 2528  
      7.8.22 **LE暗号化コマンド** ................................................ 2529  
      7.8.23 **LEランダムコマンド** ................................................ 2531  
      7.8.24 **LE暗号化有効化コマンド** ............................... 2532  
      7.8.25 **LE長期鍵要求応答コマンド** ............ 2534  
      7.8.26 **LE長期鍵要求否定応答コマンド** ........................... 2536  
      7.8.27 **LEサポート状態読み取りコマンド** ....................... 2537  
      7.8.28 **LE受信テストコマンド** ....................................... 2541  
      7.8.29 **LE送信テストコマンド** ................................... 2545  
      7.8.30 **LEテスト終了コマンド** .............................................. 2550  
      7.8.31 **LEリモート接続パラメータ要求応答コマンド** ......................... 2551  
      7.8.32 **LEリモート接続パラメータ要求否定応答コマンド** ......................................... 2554  
      7.8.33 **LEデータ長設定コマンド** .................................. 2556  
      7.8.34 **LE推奨デフォルトデータ長読み取りコマンド** . 2558  
      7.8.35 **LE推奨デフォルトデータ長書き込みコマンド** . 2560  
      7.8.36 **LEローカルP-256公開鍵読み取りコマンド** .............. 2562  
      7.8.37 **LE DHKey生成コマンド** ................................. 2563  
      7.8.38 **LEデバイス追加解決リストコマンド** .............. 2565  
      7.8.39 **LEデバイス削除解決リストコマンド** .. 2567  
      7.8.40 **LE解決リストクリアコマンド** ............................ 2569  
      7.8.41 **LE解決リストサイズ読み取りコマンド** .................... 2570  
      7.8.42 **LEピア解決可能アドレス読み取りコマンド** .......... 2571  
      7.8.43 **LEローカル解決可能アドレス読み取りコマンド** ......... 2573  
      7.8.44 **LEアドレス解決有効化コマンド** ........... 2575  
      7.8.45 **LE解決可能プライベートアドレスタイムアウト設定コマンド** 2577  
      7.8.46 **LE最大データ長読み取りコマンド** ............... 2578  
      7.8.47 **LE PHY読み取りコマンド** ........................................... 2580  
      7.8.48 **LEデフォルトPHY設定コマンド** .................................. 2582  
      7.8.49 **LE PHY設定コマンド** ............................................... 2584  
      7.8.50 [このセクションは使用されていません] ................................. 2587  
      7.8.51 [このセクションは使用されていません] ................................. 2587  
      7.8.52 **LE広告セットランダムアドレス設定コマンド** . 2588  
      7.8.53 **LE拡張広告パラメータ設定コマンド** 2590  
      7.8.54 **LE拡張広告データ設定コマンド** ........... 2600  
      7.8.55 **LE拡張スキャン応答データ設定コマンド** .... 2604  
      7.8.56 **LE拡張広告有効化コマンド** ........ 2607  
      7.8.57 **LE最大広告データ長読み取りコマンド** 2612  
      7.8.58 **LEサポート広告セット数読み取りコマンド** 2613  
      7.8.59 **LE広告セット削除コマンド** ...................... 2614  
      7.8.60 **LE広告セットクリアコマンド** ......................... 2615  
      7.8.61 **LE周期的広告パラメータ設定コマンド** ... 2616  
      7.8.62 **LE周期的広告データ設定コマンド** .............. 2621  
      7.8.63 **LE周期的広告有効化コマンド** .......... 2624  
      7.8.64 **LE拡張スキャンパラメータ設定コマンド** .......... 2626  
      7.8.65 **LE拡張スキャン有効化コマンド** ................. 2629  
      7.8.66 **LE拡張接続作成コマンド** .............. 2633  
      7.8.67 **LE周期的広告同期作成コマンド** ........ 2642  
      7.8.68 **LE周期的広告同期作成キャンセルコマンド** 2646  
      7.8.69 **LE周期的広告同期終了コマンド** ... 2647  
      7.8.70 **LEデバイス追加周期広告リストコマンド** 2648  
      7.8.71 **LE 周期広告リストからデバイス削除コマンド** .................................................... 2650  
      7.8.72 **LE 周期広告リストクリアコマンド** ............................................................ 2652  
      7.8.73 **LE 周期広告リストサイズ読み取りコマンド** ........................................... 2653  
      7.8.74 **LE 送信電力読み取りコマンド** ............................................................... 2654  
      7.8.75 **LE RF パス補正読み取りコマンド** ....................................................... 2655  
      7.8.76 **LE RF パス補正書き込みコマンド** .................................................... 2656  
      7.8.77 **LE プライバシーモード設定コマンド** ................................................... 2658  
      7.8.78 [このセクションは使用されていません] .................................................... 2660  
      7.8.79 [このセクションは使用されていません] .................................................... 2660  
      7.8.80 **LE 接続レス CTE 送信パラメータ設定コマンド** ........................................... 2661  
      7.8.81 **LE 接続レス CTE 送信有効化コマンド** ................................................... 2664  
      7.8.82 **LE 接続レス IQ サンプリング有効化コマンド** ............................................ 2666  
      7.8.83 **LE 接続 CTE 受信パラメータ設定コマンド** ................................................ 2669  
      7.8.84 **LE 接続 CTE 送信パラメータ設定コマンド** ................................................. 2672  
      7.8.85 **LE 接続 CTE 要求有効化コマンド** ....................................................... 2675  
      7.8.86 **LE 接続 CTE 応答有効化コマンド** ....................................................... 2679  
      7.8.87 **LE アンテナ情報読み取りコマンド** ....................................................... 2681  
      7.8.88 **LE 周期広告受信有効化コマンド** .......................................................... 2683  
      7.8.89 **LE 周期広告同期転送コマンド** ........................................................... 2685  
      7.8.90 **LE 周期広告セット情報転送コマンド** ...................................................... 2687  
      7.8.91 **LE 周期広告同期転送パラメータ設定コマンド** ............................................ 2689  
      7.8.92 **LE デフォルト周期広告同期転送パラメータ設定コマンド** ......................... 2692  
      7.8.93 [このセクションは使用されていません] .................................................... 2695  
      7.8.94 **LE スリープクロック精度変更コマンド** ................................................ 2696  
      7.8.95 [このセクションは使用されていません] .................................................... 2698  
      7.8.96 **LE ISO TX Sync 読み取りコマンド** ...................................................... 2699  
      7.8.97 **LE CIG パラメータ設定コマンド** ......................................................... 2701  
      7.8.98 **LE CIG パラメータテスト設定コマンド** .................................................... 2709  
      7.8.99 **LE CIS 作成コマンド** ............................................................ 2718  
      7.8.100 **LE CIG 削除コマンド** ......................................................... 2721  
      7.8.101 **LE CIS 要求受諾コマンド** ....................................................... 2723  
      7.8.102 **LE CIS 要求拒否コマンド** ...................................................... 2724  
      7.8.103 **LE BIG 作成コマンド** ........................................................... 2726  
      7.8.104 **LE BIG テスト作成コマンド** ....................................................... 2731  
      7.8.105 **LE BIG 終了コマンド** .................................................. 2737  
      7.8.106 **LE BIG 同期作成コマンド** ......................................... 2739  
      7.8.107 **LE BIG 同期終了コマンド** ......................................... 2743  
      7.8.108 **LE ピア SCA 要求コマンド** ....................................... 2745  
      7.8.109 **LE ISO データパス設定コマンド** .............................. 2746  
      7.8.110 **LE ISO データパス削除コマンド** ............................... 2750  
      7.8.111 **LE ISO 送信テストコマンド** ......................................... 2752  
      7.8.112 **LE ISO 受信テストコマンド** ......................................... 2754  
      7.8.113 **LE ISO テストカウンタ読み取りコマンド** ............... 2756  
      7.8.114 **LE ISO テスト終了コマンド** ....................................... 2758  
      7.8.115 **LE ホスト機能設定コマンド** ....................................... 2760  
      7.8.116 **LE ISO リンク品質読み取りコマンド** ....................... 2762  
      7.8.117 **LE 拡張送信電力レベル読み取りコマンド** ............. 2765  
      7.8.118 **LE リモート送信電力レベル読み取りコマンド** ......... 2768  
      7.8.119 **LE パス損失レポートパラメータ設定コマンド** ........ 2770  
      7.8.120 **LE パス損失レポート有効化コマンド** ..................... 2773  
      7.8.121 **LE 送信電力レポート有効化コマンド** ...................... 2775  
      7.8.122 **LE データ関連アドレス変更設定コマンド** ............... 2777  
      7.8.123 **LE デフォルトサブレート設定コマンド** .................... 2779  
      7.8.124 **LE サブレート要求コマンド** ....................................... 2782  
      7.8.125 **LE 周期広告サブイベントデータ設定コマンド** ......... 2786  
      7.8.126 **LE 周期広告応答データ設定コマンド** ..................... 2790  
      7.8.127 **LE 周期同期サブイベント設定コマンド** ................... 2793  
      7.8.128 **LE ローカル対応機能読み取りコマンド** ................... 2795  
      7.8.129 **LE リモート対応機能読み取りコマンド** ................... 2796  
      7.8.130 **LE CS ローカル対応機能読み取りコマンド** ............ 2798  
      7.8.131 **LE CS リモート対応機能読み取りコマンド** .............. 2805  
      7.8.132 **LE CS キャッシュリモート対応機能書き込みコマンド** 2807  
      7.8.133 **LE CS セキュリティ有効化コマンド** ....................... 2815  
      7.8.134 **LE CS デフォルト設定コマンド** ................................ 2816  
      7.8.135 **LE CS リモート FAE テーブル読み取りコマンド** ....... 2819  
      7.8.136 **LE CS キャッシュリモート FAE テーブル書き込みコマンド** 2820  
      7.8.137 **LE CS 構成作成コマンド** ........................................ 2822  
      7.8.138 **LE CS 構成削除コマンド** ........................................ 2828  
      7.8.139 **LE CS チャネル分類設定コマンド** ........................... 2830  
      7.8.140 **LE CS 手順パラメータ設定コマンド** ........................ 2832  
      7.8.141 **LE CS 手順有効化コマンド** ...................................... 2838  
      7.8.142 **LE CS テストコマンド** ................................................ 2840  
      7.8.143 **LE CS テスト終了コマンド** ........................................ 2855  
      7.8.144 **LE 決定データ設定コマンド** ..................................... 2856  
      7.8.145 **LE 決定指示設定コマンド** ............................................. 2858  
      7.8.146 **LE 広告モニターリストにデバイス追加コマンド** .............. 2867  
      7.8.147 **LE 広告モニターリストからデバイス削除コマンド** .......... 2870  
      7.8.148 **LE 広告モニターリストクリアコマンド** .......................... 2872  
      7.8.149 **LE 広告モニタリング有効化コマンド** ............................ 2873  
      7.8.150 **LE 広告モニターリストサイズ読み取りコマンド** .............. 2875  
      7.8.151 **LE フレームスペース更新コマンド** ............................... 2876  

# [このボリュームはもはや使用されていません]  
## Specification Volume 5  

